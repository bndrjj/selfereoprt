const indicatorTexts = {
  "1-1": [
    ["1-1-1-1", "تضع المدرسة خطة تشغيلية شاملة، وفق أهداف تطويرية محددة."],
    ["1-1-1-2", "تتابع المدرسة تنفيذ خطتها التشغيلية وتطورها بما يضمن تحقيق أهدافها."],
  ],
  "1-2": [
    ["1-2-1-1", "تعزز المدرسة القيم الاسلامية والهوية الوطنية."],
    ["1-2-1-2", "تطبق المدرسة قيم مهنة التعليم واخلاقياتها وتتابع الالتزام بها"],
    ["1-2-1-3", "تطبق المدرسة إجراءات محددة لدعم الانضباط المدرسي وتتابع الالتزام بها"],
    ["1-2-1-4", "تنفذ المدرسة برامج وأنشطة تربوية داعمة للسلوك الإيجابي، لدى المتعلمين ومنهم ذوو الإعاقة والموهوبون وتتابعها"],
    ["1-2-1-5", "تنفذ المدرسة برامج وأنشطة إثرائية؛ لتطوير مواهب المتعلمين وتهيئتهم للمستقبل وتتابعها"],
  ],
  "1-3": [
    ["1-3-1-1", "تعزز المدرسة بناء العلاقات الايجابية والتعاون في المجتمع المدرسي"],
    ["1-3-1-2", "تعزز المدرسة مشاركة الاسرة في تعلم أبنائها، والتحضير لمستقبلهم"],
    ["1-3-1-3", "تعزز المدرسة الشراكة المجتمعية؛ لدعم التعلم والتأثير الايجابي في المجتمع"],
  ],
  "1-4": [
    ["1-4-1-1", "توفر المدرسة كادرا تعليميا مكتملا ً ومؤهلا بما يتسق مع المهام الموكلة له"],
    ["1-4-1-2", "توفر المدرسة كادرا إداريا مكتملا ً ومؤهلا بما يتسق مع المهام الموكلة له"],
    ["1-4-1-3", "تظهر المدرسة الملاءة والاستدامة مالية."],
    ["1-4-1-4", "تدعم المدرسة منسوبيها للحصول على الرخصة المهنية، وتتابعها"],
    ["1-4-1-5", "تدعم المدرسة التطوير المهني لمنسوبيها وفقًا لنتائج التقويم وتحليل احتياجاتهم"],
    ["1-4-1-6", "تطبق المدرسة التقويم الذاتي المبني على المعايير المعتمدة من الهيئة بشكل مستمر"],
    ["1-4-1-7", "تنفذ المدرسة خطة للتحسين بناء على نتائج التقويم المدرسي، وتتابعها"],
  ],
  "1-5": [
    ["1-5-1-1", "تلتزم المدرسة بالمحافظة على حقوق المتعلمين وحمايتهم"],
    ["1-5-1-2", "توفر المدرسة مناخًا آمنًا للتعلم والنمو نفسيا واجتماعيا"],
  ],
  "2-1": [
    ["2-1-1-1", "توفر المدرسة فرصًا متكافئة للتعلم تلبي احتياجات المتعلمين ومنهم ذوو الإعاقة والموهوبون."],
    ["2-1-1-2", "تدعم المدرسة تنفيذ المناهج؛ بما يحقق نواتج التعلم المستهدفة"],
    ["2-1-1-3", "تنوع المدرسة في إستراتيجيات التعليم والتعلم لتلبية احتياجات المتعلمين، ودعم تعلمهم."],
    ["2-1-1-4", "تفعل المدرسة التقنية الرقمية ؛ لدعم تعلم المتعلمين وتلبية احتياجاتهم"],
    ["2-1-1-5", "تنفذ المدرسة أنشطة تعلم تطبيقية ترتبط بحياة المتعلمين"],
    ["2-1-1-6", "تنمي المدرسة المهارات القرائية والعددية الاساسية لدى المتعلمين"],
    ["2-1-1-7", "تنمي المدرسة مهارات التفكير والبحث والابتكار لدى المتعلمين."],
    ["2-1-1-8", "تنمي المدرسة المهارات العاطفية الاجتماعية لدى المتعلمين"],
    ["2-1-1-9", "تعزز المدرسة دافعية المتعلمين للتعلم والاستمتاع به."],
  ],
  "2-2": [
    ["2-2-1-1", "تطبق المدرسة أساليب وأدوات تقويم متنوعة: للكشف عن مستويات أداء المتعلمين المختلفة"],
    ["2-2-1-2", "تطبق المدرسة أساليب وأدوات متنوعة : لتقويم نواتج التعلم المستهدفة في مناهج التعليم"],
    ["2-2-1-3", "تحلل المدرسة نتائج التقويم وتوظفها في تحسين عمليات التعليم والتعلم والتقويم"],
    ["2-2-1-4", "تقدم المدرسة التغذية الراجعة للمتعلمين وأولياء امورهم وتتابع تقدمهم بشكل مستمر"],
  ],
  "3-1": [
    ["3-1-1-1", "يحقق المتعلمون نتائج مرتفعة في مجال القراءة وفقًا للاختبارات الوطنية."],
    ["3-1-1-2", "يحقق المتعلمون نتائج مرتفعة في مجال الرياضيات وفقًا للاختبارات الوطنية."],
    ["3-1-1-3", "يحقق المتعلمون نتائج مرتفعة في مجال العلوم وفقًا للاختبارات الوطنية."],
    ["3-1-1-4", "يحقق المتعلمون تقدما في مجال القراءة قياسا على مستوى أداء المدرسة السابق في الاختبارات الوطنية"],
    ["3-1-1-5", "يحقق المتعلمون تقدما في مجال الرياضيات قياسا على مستوى أداء المدرسة السابق في الاختبارات الوطنية"],
    ["3-1-1-6", "يحقق المتعلمون تقدما في مجال العلوم قياسا على مستوى أداء المدرسة السابق في الاختبارات الوطنية"],
  ],
  "3-2": [
    ["3-2-1-1", "يظهر المتعلمون الاعتزاز بالقيم والهوية الوطنية"],
    ["3-2-1-2", "يظهر المتعلمون اتجاهات إيجابية نحو ذواتهم"],
    ["3-2-1-3", "يظهر المتعلمون التزاما بالممارسات الصحية السليمة."],
    ["3-2-1-4", "يشارك المتعلمون في الانشطة المجتمعية والاعمال التطوعية."],
    ["3-2-1-5", "يلتزم المتعلمون بقواعد السلوك والانضباط المدرسي."],
    ["3-2-1-6", "يظهر المتعلمون الاستقلالية والقدرة على التعلم الذاتي"],
    ["3-2-1-7", "يظهر المتعلمون اعتزازا بثقافتهم واحتراما للتنوع الثقافي في المجتمع"],
  ],
  "4-1": [
    ["4-1-1-1", "توفر المدرسة مبنى تعليمي يستوفي المواصفات والاشتراطات المعتمدة من حيث النوع والخدمات المساندة"],
    ["4-1-1-2", "تنظيم مبنى المدرسة ملائم لعدد المتعلمين وخصائص المرحلة العمرية، ومنهم ذوو الاعاقة"],
    ["4-1-1-3", "تتوافر فصول ومعامل ملائمة للعملية التعليمية تلبي احتياجات المتعلمين ومنهم ذوو الاعاقة."],
    ["4-1-1-4", "تلبي المرافق والتجهيزات والخدمات المساندة احتياجات المتعلمين ومنهم ذوو الاعاقة."],
  ],
  "4-2": [
    ["4-2-1-1", "تتوافر في مبنى المدرسة ومرافقها جميع متطلبات الامن والسلامة."],
    ["4-2-1-2", "تتابع المدرسة صيانة المبنى وجميع مرافقه وتجهيزاته بشكل دوري"],
    ["4-2-1-3", "تتابع المدرسة نظافة المبنى المدرسي وجميع مرافقه بشكل مستمر"],
  ],
};

const evidenceTemplate = [
  "وجود خطة/إجراء مكتوب ومعتمد مرتبط بالمؤشر.",
  "تنفيذ فعلي موثق (أنشطة، محاضر، صور، تقارير).",
  "تحديد الأدوار والمسؤوليات بوضوح.",
  "متابعة دورية مع مؤشرات قياس.",
  "تحليل تحديات وتطبيق تحسينات علاجية.",
  "مشاركة أصحاب العلاقة وتوثيق الأثر."
];

const documentsTemplate = [
  "خطة عمل معتمدة مرتبطة بالمؤشر.",
  "سجلات متابعة حديثة وموقعة.",
  "تقارير تحليل النتائج والتحسين.",
  "نماذج/أدلة تنفيذ داعمة."
];

const indicatorGuides = {
  "1-1-1-1": {
    procedures: ["لم تذكر الإجراءات المباشرة لهذا المؤشر في النصوص المرفقة."],
    assessmentTools: [
      "تحليل الوثائق (خطة المدرسة التشغيلية).",
      "المقابلات (الإدارة المدرسية)."
    ]
  },
  "1-1-1-2": {
    procedures: [
      "لديها إجراءات محددة لمتابعة تنفيذ خطة التشغيلية.",
      "تتابع تنفيذ البرامج والأنشطة وفق خطة زمنية واضحة.",
      "تُقوّم تنفيذ خطتها بما يضمن تحقيق أهدافها بأساليب متنوعة.",
      "ترصد الفجوة بين المستهدف في الخطة التشغيلية ونتائج التنفيذ الفعلي؛ وتقدم الحلول اللازمة.",
      "تطور خطتها وفق المستجدات بما يضمن تحقيق أهدافها."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (الإدارة المدرسية).",
      "تحليل الوثائق."
    ]
  },
  "1-2-1-1": {
    procedures: [
      "تستهدف تعزيز القيم الإسلامية والهوية الوطنية في خططها وبرامجها وأنشطتها الصفية وغير الصفية بصورة واضحة.",
      "تستثمر المناسبات لتعزيز القيم الإسلامية والهوية الوطنية في الأنشطة الصفية وغير الصفية.",
      "تستثمر المناسبات لتعزيز القيم الإسلامية والهوية الوطنية في المجتمع المحلي (الشراكة مع الأسرة).",
      "تشرف المدرسة على تنفيذ الأنشطة والبرامج بأساليب متنوعة (3 فأكثر) أو مبتكرة.",
      "تنفيذ برامج الوعي الفكري وفق قواعده وخططه المعتمدة.",
      "تعمق الممارسات اليومية التي تعزز القيم الإسلامية والهوية الوطنية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (الموجه الطالبي).",
      "تحليل الوثائق (خطة التوجيه الطالبي وتقاريره)."
    ]
  },
  "1-2-1-3": {
    procedures: [
      "تتابع حالات الطالب متكرري الغياب والتأخر الصباحي، وتتخذ الإجراءات التصحيحية اللازمة.",
      "تطبق إجراءات واضحة ومعلنة للمساءلة عن الغياب.",
      "تطبق إجراءات واضحة للحد من المخالفات السلوكية.",
      "تنفذ برامج وقائية وعلاجية تدعم الانضباط المدرسي.",
      "تعمق الممارسات اليومية التي تدعم الانضباط المدرسي."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (الموجه الطالبي).",
      "تحليل الوثائق (خطة التوجيه الطالبي وتقاريره)."
    ]
  },
  "1-2-1-5": {
    procedures: [
      "وضعت خطة للأنشطة الإثرائية الصفية وغير الصفية وتوفر آلية لمتابعة تنفيذها.",
      "تطبق برامج إثرائية لتطوير مواهب المتعلمين وتوفر آلية لمتابعة تنفيذها.",
      "تدعم المشاركة في المسابقات الوطنية والدولية.",
      "توفر برامج وأنشطة إثرائية تهيئ المتعلمين لمستقبلهم الأكاديمي والمهني.",
      "تطبق أساليب الكشف عن مواهب وقدرات المتعلمين.",
      "تنشر ثقافة التميز وتدعم وتشجع المتميزين.",
      "تعمق الممارسات اليومية المتعلقة بتطوير مواهب المتعلمين وتهيئتهم للمستقبل."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "تحليل الوثائق (البرامج والأنشطة الإثرائية)."
    ]
  },
  "1-3-1-1": {
    procedures: [
      "يوجد لديها خطة لتعزيز العمل التعاوني بين منسوبيها وتوفر آلية لمتابعتها.",
      "يوجد لديها مهام متنوعة تشجع التعاون والعمل بروح الفريق في المجتمع المدرسي/المحلي.",
      "متابعة تطبيق المهام التعاونية بأساليب متنوعة.",
      "تسودها علاقات إيجابية قائمة على الاحترام المتبادل بين منسوبيها.",
      "يوجد لديها أنشطة ترفيهية ورياضية وثقافية تعزز العلاقات الإيجابية في المجتمع المدرسي.",
      "تعمق الممارسات اليومية المعززة للعلاقات الإيجابية والتعاون في المجتمع المدرسي."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (المعلم).",
      "تحليل الوثائق."
    ]
  },
  "1-3-1-3": {
    procedures: [
      "توفر فرصًا للتواصل والتعاون مع مؤسسات المجتمع لتعزيز تعلم المتعلمين.",
      "تستثمر إمكانات المؤسسات الوطنية في تلبية احتياجات ذوي الإعاقة والموهوبين.",
      "نظمت أنشطة وفعاليات توعوية للمجتمع المحلي وتوجيه إمكاناتها لخدمته.",
      "توفر فرصاً للتواصل مع المجتمع المحلي بطرق متنوعة.",
      "تقيم شراكة فعالة مع المؤسسات الوطنية.",
      "تستثمر المدرسة إمكانات الشراكات المجتمعية لدعم تعلم المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، الأسرة).",
      "المقابلات (الإدارة المدرسية).",
      "تحليل الوثائق."
    ]
  },
  "1-4-1-1": {
    procedures: [
      "توفر كادر تعليمي مكتمل ومؤهل.",
      "توافق مجال التخصص في المؤهل العلمي للكادر التعليمي مع العمل المكلف به.",
      "وجود معايير واضحة لاختيار الكوادر التعليمية.",
      "تحديد الوظائف الشاغرة في المدرسة والمهارات المطلوبة لكل وظيفة.",
      "وجود طرق متنوعة لتقييم المتقدمين مثل المقابلات الشخصية والاختبارات.",
      "تقديم التدريب والدعم اللازم للمعلمين الجدد."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (الإدارة المدرسية).",
      "تحليل الوثائق."
    ]
  },
  "1-4-1-2": {
    procedures: [
      "وجود تشكيل إداري مكتمل للقيام بالمهام الإدارية.",
      "توافق مؤهل وخبرة الكادر الإداري مع المهام والأعمال المكلف بها.",
      "وجود معايير واضحة لاختيار الكادر الإداري.",
      "تحديد الوظائف الشاغرة في المدرسة والمهام والمهارات المطلوبة لكل وظيفة.",
      "نشر إعلانات عن الوظائف الشاغرة في المنصات المناسبة.",
      "وجود طرق لتقييم المتقدمين مثل المقابلات الشخصية والاختبارات."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (الإدارة المدرسية).",
      "تحليل الوثائق."
    ]
  },
  "1-4-1-4": {
    procedures: [
      "وجود أنشطة وبرامج توعوية للحصول على الرخص المهنية.",
      "تقديم الدعم المستمر للمعلمين للحصول على الرخص المهنية.",
      "تحديد الاحتياجات التدريبية للمعلمين وتأهليهم للحصول على الرخص المهنية."
    ],
    assessmentTools: [
      "نتائج الرخص المهنية.",
      "الاستبانات (المعلم).",
      "تحليل الوثائق."
    ]
  },
  "1-4-1-5": {
    procedures: [
      "يوجد لديها خطة للتطوير المهني وفق نتائج تقويم الأداء الوظيفي واحتياجات منسوبيها.",
      "نفذت خطة التطوير المهني لمنسوبيها وتوفر آلية لمتابعتها بانتظام.",
      "تشرك المعلمين/ات في مجتمعات التعلم المهني.",
      "تقيس أثر برامج التطوير المهني على أداء المعلمين.",
      "دعمت وتشجع منسوبيها على الالتحاق بالبرامج التدريبية.",
      "تدعم المعلمين في إجراء البحوث والدراسات الإجرائية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (المعلم).",
      "تحليل الوثائق (خطة التطوير المهني لمنسوبي المدرسة)."
    ]
  },
  "1-4-1-6": {
    procedures: [
      "نشر ثقافة التقويم الذاتي في المجتمع المدرسي والمحلي بأساليب متنوعة.",
      "تشكيل فريق التقويم الذاتي وفق المعايير المحددة في الدليل الإجرائي للتقويم الذاتي.",
      "تطبيق التقويم الذاتي المبني على المعايير المعتمدة من الهيئة.",
      "إشراك منسوبي/ات المدرسة في عمليات التقويم الذاتي ونتائجه.",
      "توثيق جميع إجراءات وعمليات التقويم الذاتي المطبق فعلياً."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "تحليل الوثائق."
    ]
  },
  "1-4-1-7": {
    procedures: [
      "وجود خطة التحسين في ضوء نتائج التقويم المدرسي.",
      "تنفيذ خطة التحسين وتوفر آلية لمتابعتها.",
      "التركيز في خطة التحسين على الأولويات وفقاً لنتائج التقويم الذاتي للمدرسة.",
      "تنفيذ برامج وأنشطة خطة التحسين.",
      "متابعة تنفيذ خطة التحسين بانتظام.",
      "تطوير خطة التحسين وإجراءات التنفيذ بشكل مستمر."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (الإدارة المدرسية).",
      "تحليل الوثائق (خطة متابعة مؤشرات الأداء وتقاريرها)."
    ]
  },
  "1-5-1-1": {
    procedures: [
      "تنفذ برامج توعوية بحقوق المتعلمين وسبل الحماية.",
      "توضح آليات الإبلاغ وطلب المساعدة داخل المدرسة وخارجها.",
      "تطبيق قواعد السلوك والمواظبة بما يضمن حقوق المتعلمين في المجتمع المدرسي.",
      "تطبيق إجراءات حماية شاملة تراعي جميع المتعلمين ومنهم ذوو الإعاقة والموهوبون.",
      "نشر الخطوط الساخنة: (مركز بلاغات العنف الأسري 1919، وخط مساندة الطفل 116111).",
      "توثيق الحقوق: الأسرية والشخصية، الحق في الحضانة، والرعاية الأسرية.",
      "توفر حماية للمتعلم من الإساءة الجسدية، النفسية، الجنسية.",
      "رصد وتعالج حالات الإهمال وتوفر الحاجات الأساسية لهم.",
      "تعمق الممارسات اليومية الدالة على المحافظة على حقوق المتعلمين وحمايتهم من الإيذاء."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (الموجه الطالبي).",
      "تحليل الوثائق (الإجراءات المتبعة لحماية المتعلم والحفاظ على حقوقه)."
    ]
  },
  "1-5-1-2": {
    procedures: ["لم تذكر الإجراءات المباشرة لهذا المؤشر في النصوص المرفقة."],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (الموجه الطالبي).",
      "تحليل الوثائق (خطة التوجيه الطالبي وتقاريره)."
    ]
  },
  "2-1-1-1": {
    procedures: [
      "توفر مصادر وأنشطة متنوعة تلبي احتياجات سريعي التعلم والموهوبين.",
      "تتيح فرص متكافئة للمتعلمين في استخدام المصادر والأنشطة."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم).",
      "المقابلات (المتعلم).",
      "الملاحظة الصفية."
    ]
  },
  "2-1-1-2": {
    procedures: [
      "توفر أنشطة ومصادر لدعم تعلم محتوى المناهج (المعارف والمهارات والقيم).",
      "تتابع تنفيذ المناهج لتحقيق نواتج التعلم المستهدفة وفق الخطة الدراسية.",
      "تقدم التغذية الراجعة ومقترحات التحسين.",
      "تعمل على تأمين حصص للمعلم المتأخر في المنهج للسير وفق الخطة الدراسية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم).",
      "المقابلات (المعلم).",
      "الملاحظة الصفية."
    ]
  },
  "2-1-1-3": {
    procedures: [
      "متنوعة تركز على المشاركة والتعلم النشط.",
      "تلائم قدرات المتعلمين وخبراتهم.",
      "تراعي الفروق الفردية بين المتعلمين.",
      "تتسق مع نواتج التعلم المستهدفة.",
      "تدعم تعلم ذوي صعوبات التعلم وذوي الإعاقة.",
      "تعلم سريعي التعلم والموهوبين."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم).",
      "المقابلات (المعلم).",
      "الملاحظة الصفية."
    ]
  },
  "2-1-1-4": {
    procedures: [
      "تضع إجراءات محددة لدعم التعلم الإلكتروني ضمن التعليم المدرسي اليومي.",
      "تضع إجراءات محددة للطوارئ (التعلم عن بعد)."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (الإدارة المدرسية).",
      "الملاحظة الصفية."
    ]
  },
  "2-1-1-6": {
    procedures: [
      "تنمية المهارات القرائية والعددية الأساسية لدى المتعلمين.",
      "تطبيق أنشطة تعلم تنمي مهارات القراءة والكتابة بطرق متنوعة.",
      "تطبيق أنشطة تعلم تنمي المهارات العددية (الحساب) بطرق متنوعة.",
      "وجود أنشطة علاجية وإثرائية متنوعة لتنمية مهارات القراءة والكتابة.",
      "وجود أنشطة علاجية وإثرائية متنوعة لتنمية المهارات العددية (الحساب).",
      "مشاركة المتعلمين في المسابقات الوطنية.",
      "مشاركة المتعلمين على المشاركة في المسابقات الدولية.",
      "تعميق الممارسات اليومية الدالة على تنمية المهارات القرائية والعددية الأساسية لدى المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (المتعلم).",
      "الملاحظة الصفية.",
      "تحليل الوثائق (عينة من ملفات إنجاز المتعلمين)."
    ]
  },
  "2-1-1-7": {
    procedures: [
      "تطبيق أنشطة تنمي مهارات التفكير العليا (الناقد والإبداعي وحل المشكلات) لدى المتعلمين.",
      "وجود أنشطة علاجية متنوعة لتنمية مهارات التفكير العليا.",
      "وجود أنشطة إثرائية متنوعة لتنمية مهارات التفكير العليا.",
      "دمج مهارات التفكير في الموضوعات الدراسية.",
      "تعميق الممارسات اليومية الداعمة لتنمية مهارات التفكير والبحث والابتكار لدى المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (المتعلم).",
      "الملاحظة الصفية.",
      "تحليل الوثائق (عينة من ملفات إنجاز المتعلمين)."
    ]
  },
  "2-1-1-9": {
    procedures: [
      "ينظم بيئة تعلم تعزز المهارات العاطفية والاجتماعية لدى المتعلمين.",
      "يقدم أنشطة تعلم تستهدف تنمية القدرة على التحكم في العواطف وضبط الانفعالات لدى جميع المتعلمين.",
      "ينظم بيئة تعلم تشجع العمل التعاوني.",
      "يشجع المتعلمين على المناقشة والحوار الفعال.",
      "ينظم بيئة تعلم تعزز الاحترام المتبادل بين المتعلمين."
    ],
    assessmentTools: [
      "المقابلات (المعلم).",
      "الملاحظة الصفية."
    ]
  },
  "2-2-1-1": {
    procedures: [
      "يستخدم أساليب وأدوات تقويم متنوعة تظهر التمايز في أداء المتعلمين.",
      "يوظف نتائج التقويم التشخيصي والتكويني؛ لتحديد الفجوات التعليمية وتصنيف المتعلمين إلى فئات الأداء الأساسية.",
      "يفعل التقويم الإلكتروني وأدوات التحليل الرقمية: لرصد مستويات الأداء واتجاهات التقدم.",
      "يعمق تطبيق الكشف عن مستويات أداء المتعلمين المختلفة من خلال ممارسات يومية مشاهدة."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "تحليل الوثائق (عينة من نماذج تقويم أداء المتعلمين).",
      "الملاحظة الصفية."
    ]
  },
  "2-2-1-2": {
    procedures: [
      "يطبق أساليب تقويم متنوعة وفاعلة؛ لقياس نواتج التعلم المستهدفة في المناهج.",
      "يوظف نتائج التقويم؛ لتحديد نواتج التعلم غير المتحققة.",
      "ينفذ معالجات تعليمية مرتبطة بنواتج التعلم.",
      "مراجعة دورية لجودة التقويم ومدى ملاءمته لنواتج التعلم، وتطوير الأدوات والمعايير بناء على النتائج؛ لضمان التحسين المستمر لنواتج التعلم.",
      "يعمق الممارسات اليومية الدالة على تطبيق أساليب وأدوات لتقويم نواتج التعلم."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "تحليل الوثائق (عينة من سجلات متابعة أداء المتعلمين).",
      "الملاحظة الصفية."
    ]
  },
  "2-2-1-3": {
    procedures: [
      "يحلل نتائج تقويم أداء المتعلمين، ويوظفها في تحسين تعلم المتعلمين بانتظام.",
      "يجمع بيانات حول تعلم المتعلمين بطرق متنوعة ويحلل.",
      "يفسر نتائج التقويم ويحدد أسباب الصعوبات التعليمية.",
      "يوظف نتائج التقويم في بناء خطط علاجية للمتعلمين، ويطور ممارساته التدريسية.",
      "يتابع تنفيذ الخطط العلاجية بانتظام."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "تحليل الوثائق.",
      "المقابلات (المعلم)."
    ]
  },
  "2-2-1-4": {
    procedures: [
      "يقدم تغذية راجعة للمتعلمين بانتظام.",
      "يقدم المعلم تغذية راجعة فورية أثناء التعلم.",
      "التغذية الراجعة تعزز التعلم الذاتي لدى المتعلمين.",
      "يقدم المعلم تغذية راجعة بطرق متنوعة.",
      "يوظف المتعلم التغذية الراجعة في تحسين أدائهم بانتظام.",
      "التغذية الراجعة تراعي الفروق الفردية بين المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "تحليل الوثائق.",
      "المقابلات (المعلم)."
    ]
  },
  "3-1-1-1": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختباري القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس.",
      "نتائج الطلبة في القدرات.",
      "نتائج الطلبة في التحصيلي."
    ]
  },
  "3-1-1-2": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختباري القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس.",
      "نتائج الطلبة في القدرات.",
      "نتائج الطلبة في التحصيلي."
    ]
  },
  "3-1-1-3": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختباري القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس.",
      "نتائج الطلبة في القدرات.",
      "نتائج الطلبة في التحصيلي."
    ]
  },
  "3-2-1-5": {
    procedures: [
      "نسبة المتعلمين الملتزمين بقواعد السلوك.",
      "نسبة المتعلمين الملتزمين المنتظمين في الحضور.",
      "تعزيز السلوك الإيجابي والانضباط المدرسي.",
      "رصد حالات الغياب والتأخر والمخالفات السلوكية.",
      "تعميق الممارسات اليومية الدالة على التزام المتعلمين بقواعد السلوك والانضباط."
    ],
    assessmentTools: [
      "الاستبانات (المعلم).",
      "المقابلات (المعلم).",
      "تحليل الوثائق (تقارير الانضباط المدرسي والسلوك).",
      "الملاحظة الصفية.",
      "ملاحظة بيئة التعلم."
    ]
  },
  "3-2-1-6": {
    procedures: [
      "يظهر دافعية ذاتية للتعلم.",
      "يظهر القدرة على تحديد أهداف تعلمهم.",
      "يظهر القدرة على البحث عن المعلومات من مصادر تعلم موثوقية ومتنوعة.",
      "يطبق مهارات التعلم الذاتي.",
      "له ممارسات يومية دالة على الاستقلالية والقدرة على البحث والتعلم الذاتي خلال المواقف الصفية وغير الصفية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (المعلم).",
      "الملاحظة الصفية."
    ]
  },
  "3-2-1-7": {
    procedures: [
      "اعتزازًا بثقافة المجتمع وتاريخه وتراثه.",
      "اعتزازًا بدينهم.",
      "فخرًا بلغتهم.",
      "احترامًا وتفهمًا للتنوع الثقافي للشعوب والثقافات الأخرى.",
      "ممارسات دالة على اعتزاز المتعلمين بثقافتهم واحترامًا للتنوع الثقافي في المجتمع."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة).",
      "المقابلات (المتعلم).",
      "ملاحظة بيئة التعلم.",
      "الملاحظة الصفية."
    ]
  },
  "4-1-1-1": {
    procedures: [
      "دراسة بيئة المدرسة وتقديم المقترحات التطويرية اللازمة بشأنها.",
      "التواصل مع مقدمي الخدمات للمدرسة للحصول على أفضل خدمة ممكنة.",
      "الاهتمام بمرافق المدرسة وتنظيمها ونظافتها."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم.",
      "تحليل الوثائق (نماذج التجهيزات وأدوات الأمن والسلامة)."
    ]
  },
  "4-1-1-2": {
    procedures: [
      "أثاث المبنى مناسب لخصائص المرحلة العمرية ومتطلباتها.",
      "سهولة التنقل بين مرافق المدرسة بما يتناسب مع خصائص المرحلة العمرية.",
      "ساحات المدرسة مناسبة لممارسة الأنشطة بما يتناسب مع خصائص المرحلة العمرية.",
      "تحديد المكان التربوي المناسب لذوي الإعاقة.",
      "إعداد استطالعات قياس رضا المستفيدين من خدمات المدرسة."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم.",
      "استبانة المعلم."
    ]
  },
  "4-1-1-3": {
    procedures: [
      "الفصول مناسبة لعدد المتعلمين.",
      "تجهيزات الفصول مناسبة للمتعلمين (الوسائل والأدوات والمواد اللازمة).",
      "الفصول تلبي احتياجات ذوي الإعاقة.",
      "حجم وطبيعة الطاولات والمقاعد في الفصول مناسب لخصائص المرحلة العمرية.",
      "تجهيزات المعامل مناسبة للمتعلمين، ومنهم ذوو الإعاقة (الوسائل والأدوات والمواد اللازمة).",
      "أجواء الفصول والمعامل مناسبة من حيث درجة الحرارة أو البرودة والتهوية والإضاءة."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم.",
      "استبانات (المعلم، المتعلم)."
    ]
  },
  "4-2-1-1": {
    procedures: [
      "وجود تقرير الأمن والسلامة ساري العمل به.",
      "وجود الشهادات الصحية للعاملين سارية المفعول.",
      "تنفيذ برامج وأنشطة متعلقة بالأمن والسلامة.",
      "تحديد احتياجات المدرسة من أجهزة الأمن والسلامة.",
      "وجود سجل لتنظيم دخول الزوار للمدرسة.",
      "تدريب منسوبي المدرسة على خطة الإخلاء في الحاالت الطارئة.",
      "مخارج الطوارئ ومسارات ذو الإعاقة واللوحات الإرشادية وطفايات الحريق وكواشف الدخان وأجهزة سالمة الإنذار."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم.",
      "استبانة الأسرة.",
      "تحليل الوثائق (خطة الأمن والسلامة وخطط الإخلاء وتقويمها)."
    ]
  },
  "4-2-1-2": {
    procedures: [
      "توافر خطط لأعمال الصيانة الوقائية والعالجية بانتظام.",
      "رفع بلاغات الدعم الفني والتواصل مع الجهات الخدمية لمعالجة الخلل.",
      "تنفيذ برامج توعوية داخل المدرسة للمحافظة على الممتلكات العامة والمرافق.",
      "وجود تقارير دورية لواقع مرافق وتجهيزات المدرسة، تتضمن المقترحات والإجراءات التحسينية."
    ],
    assessmentTools: [
      "استبانة المعلم.",
      "تحليل الوثائق.",
      "ملاحظة بيئة التعلم."
    ]
  },
  "4-2-1-3": {
    procedures: [
      "نظافة الفصول /الممرات والساحات/نظافة المعامل.",
      "نظافة المقصف المدرسي وأماكن الجلوس.",
      "نظافة دورات المياه/نظافة الأثاث والتجهيزات.",
      "الحاويات كافية وموزعة في مختلف أماكن المدرسة.",
      "وجود استمارة متابعة وتقييم نظافة دورات المياه."
    ],
    assessmentTools: [
      "استبانات (المعلم، المتعلم).",
      "ملاحظة بيئة التعلم."
    ]
  }
};

const indicatorGuideOverrides = {
  "1-1-1-1": {
    procedures: [
      "لديها إجراءات محددة لمتابعة تنفيذ برامج الخطة التشغيلية.",
      "تتابع تنفيذ البرامج والأنشطة وفق خطة زمنية واضحة.",
      "تُقَوِّم تنفيذ خطتها بما يضمن تحقيق أهدافها بأساليب متنوعة.",
      "ترصد الفجوة بين المستهدف في الخطة التشغيلية ونتائج التنفيذ الفعلي؛ وتقدم الحلول اللازمة.",
      "تطور خطتها وفق المستجدات بما يضمن تحقيق أهدافها."
    ],
    assessmentTools: [
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق (خطة المدرسة التشغيلية)"
    ]
  },
  "1-1-1-2": {
    procedures: [
      "تستهدف تعزيز القيم الإسلامية والهوية الوطنية بصورة واضحة في خططها وبرامجها وأنشطتها الصفية وغير الصفية.",
      "تستثمر المناسبات لتعزيز القيم الإسلامية والهوية الوطنية في الأنشطة الصفية وغير الصفية.",
      "تستثمر المناسبات لتعزيز القيم الإسلامية والهوية الوطنية في المجتمع المحلي (الشراكة مع الأسرة).",
      "تشرف المدرسة على تنفيذ الأنشطة والبرامج بأساليب متنوعة (3 فأكثر) أو مبتكرة.",
      "تنفيذ برامج الوعي الفكري وفق قواعده وخططه المعتمدة.",
      "تعمق الممارسات اليومية التي تعزز القيم الإسلامية والهوية الوطنية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق"
    ]
  },
  "1-2-1-1": {
    procedures: [
      "وزعت المهام والواجبات على منسوبي/ات المدرسة وإصدار التكاليف اللازمة لإنجاز أعمالهم.",
      "نشر الوعي بقيم مهنة التعليم وأخلاقياته لدى منسوبيها.",
      "تطبق قيم مهنة التعليم وأخلاقياته في التعامل مع منسوبيها.",
      "يظهر منسوبو المدرسة التزامًا بقواعد السلوك الوظيفي وأخلاقيات المهنة.",
      "طبقت إجراءات واضحة لمتابعة التزام منسوبيها بقيم مهنة التعليم وأخلاقياتها.",
      "يسود المدرسة علاقات إيجابية قائمة على الاحترام المتبادل والثقة.",
      "تعمق الممارسات اليومية التي تدعم الالتزام بقيم مهنة التعليم وأخلاقياته."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (خطة التوجيه الطلابي وتقاريره)"
    ]
  },
  "1-2-1-3": {
    procedures: [
      "تتابع حالات الطلاب متكرري الغياب والتأخر الصباحي، وتتخذ الإجراءات التصحيحية اللازمة.",
      "تطبق إجراءات واضحة ومعلنة للمساءلة عن الغياب.",
      "تطبق إجراءات واضحة للحد من المخالفات السلوكية.",
      "تنفذ برامج وقائية وعلاجية لدعم الانضباط المدرسي.",
      "تعمق الممارسات اليومية التي تدعم الانضباط المدرسي."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (خطة التوجيه الطلابي وتقاريره)"
    ]
  },
  "1-2-1-4": {
    procedures: [
      "تستثمر الشراكات المجتمعية لتعزيز السلوك الإيجابي.",
      "تحصر وتتابع المشكلات السلوكية والحالات الخاصة وتبني خططًا للتدخلات المناسبة.",
      "تعمق الممارسات اليومية الداعمة للسلوك الإيجابي لدى المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (خطة التوجيه الطلابي وتقاريره)"
    ]
  },
  "1-2-1-5": {
    procedures: [
      "وضعت خطة للأنشطة الإثرائية الصفية وغير الصفية وتوفر آلية لمتابعة تنفيذها.",
      "تطبق برامج إثرائية لتطوير مواهب المتعلمين وتوفر آلية لمتابعة تنفيذها.",
      "تدعم المشاركة في المسابقات الوطنية والدولية.",
      "توفر برامج وأنشطة إثرائية تهيئ المتعلمين لمستقبلهم الأكاديمي والمهني.",
      "تطبق أساليب الكشف عن مواهب وقدرات المتعلمين.",
      "تنشر ثقافة التميز وتدعم وتشجع المتميزين.",
      "تعمق الممارسات اليومية المتعلقة بتطوير مواهب المتعلمين وتهيئتهم للمستقبل"
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "تحليل الوثائق (البرامج والأنشطة الإثرائية)"
    ]
  },
  "1-3-1-1": {
    procedures: [
      "يوجد لديها خطة لتعزيز العمل التعاوني بين منسوبيها وتوفر آلية لمتابعتها.",
      "يوجد لديها مهام متنوعة تشجع التعاون والعمل بروح الفريق في المجتمع المدرسي/المحلي.",
      "متابعة تطبيق المهام التعاونية بأساليب متنوعة.",
      "تسودها علاقات إيجابية قائمة على الاحترام المتبادل بين منسوبيها.",
      "يوجد لديها أنشطة ترفيهية ورياضية وثقافية تعزز العلاقات الإيجابية في المجتمع المدرسي.",
      "تعمق الممارسات اليومية المعززة للعلاقات الإيجابية والتعاون في المجتمع المدرسي."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (المعلم)",
      "تحليل الوثائق"
    ]
  },
  "1-3-1-2": {
    procedures: [
      "توفر أنشطة وبرامج للتوعية بدور الأسرة في دعم تعلم أبنائها والتحضير لمستقبلهم.",
      "توفر فرصًا للتواصل الفعال مع الأسرة بأساليب فاعلة ومتنوعة.",
      "تقدم أنشطة وبرامج مبتكرة لتوعية المجتمع المدرسي بدور الأسرة.",
      "تشرك الأسرة في تعلم أبنائهم والتحضير لمستقبلهم.",
      "تشرك الأسرة في تقويم خدماتها وتطويرها.",
      "تعمق الممارسات الدالة على تعزيز مشاركة الأسرة في تعلم أبنائها."
    ],
    assessmentTools: [
      "الاستبانات (الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (خطة التوجيه الطلابي وتقاريره)"
    ]
  },
  "1-3-1-3": {
    procedures: [
      "توفر فرصًا للتواصل والتعاون مع مؤسسات المجتمع لتعزيز تعلم المتعلمين.",
      "تستثمر إمكانات المؤسسات الوطنية في تلبية احتياجات ذوي الإعاقة والموهوبين.",
      "نظمت أنشطة وفعاليات توعوية للمجتمع المحلي وتوجيه إمكاناتها لخدمته.",
      "توفر فرصًا للتواصل مع المجتمع المحلي بطرق متنوعة.",
      "تقيم شراكة فعالة مع المؤسسات الوطنية.",
      "تستثمر المدرسة إمكانات الشراكات المجتمعية لدعم تعلم المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، الأسرة)",
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-1": {
    procedures: [
      "توفر كادر تعليمي مكتمل ومؤهل.",
      "توافق مجال التخصص في المؤهل العلمي للكادر التعليمي مع العمل المكلف به.",
      "وجود معايير واضحة لاختيار الكوادر التعليمية.",
      "تحديد الوظائف الشاغرة في المدرسة والمهارات المطلوبة لكل وظيفة.",
      "وجود طرق متنوعة لتقييم المتقدمين مثل المقابلات الشخصية والاختبارات.",
      "تقديم التدريب والدعم اللازم للمعلمين الجدد."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-2": {
    procedures: [
      "وجود تشكيل إداري مكتمل للقيام بالمهام الإدارية.",
      "توافق مؤهل وخبرة الكادر الإداري مع المهام والأعمال المكلف بها.",
      "وجود معايير واضحة لاختيار الكادر الإداري.",
      "تحديد الوظائف الشاغرة في المدرسة والمهام والمهارات المطلوبة لكل وظيفة.",
      "نشر إعلانات عن الوظائف الشاغرة في المنصات المناسبة.",
      "وجود طرق لتقييم المتقدمين مثل المقابلات الشخصية والاختبارات."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-3": {
    procedures: [
      "وجود خطة وتقريرًا ماليًا سنويًا معتمدًا.",
      "توزيع الموارد المالية وفق أولوياتها لدعم العملية التعليمية.",
      "إظهار المدرسة القدرة على تغطية التزاماتها المالية.",
      "نشرها سياسات واضحة في الرسوم والتحصيل لأصحاب المصلحة.",
      "يوجد لدى المدرسة الموارد المالية الكافية لدعم وتحسين الجودة التعليمية المستمرة.",
      "يوجد لدى المدرسة القدرة على تغطية التزاماتها المالية.",
      "تطبق المدرسة إجراءات محددة في توزيع الميزانية."
    ],
    assessmentTools: [
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-4": {
    procedures: [
      "وجود أنشطة وبرامج توعوية للحصول على الرخص المهنية.",
      "تقديم الدعم المستمر للمعلمين للحصول على الرخص المهنية.",
      "تحديد الاحتياجات التدريبية للمعلمين وتأهيلهم للحصول على الرخص المهنية."
    ],
    assessmentTools: [
      "نتائج الرخص المهنية",
      "الاستبانات (المعلم)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-5": {
    procedures: [
      "يوجد لديها خطة للتطوير المهني وفق نتائج تقويم الأداء الوظيفي واحتياجات منسوبيها.",
      "نفذت خطة التطوير المهني لمنسوبيها وتوفر آلية لمتابعتها بانتظام.",
      "تشرك المعلمين/ات في مجتمعات التعلم المهني.",
      "تقيس أثر برامج التطوير المهني على أداء المعلمين.",
      "دعمت وتشجع منسوبيها على الالتحاق بالبرامج التدريبية.",
      "تدعم المعلمين في إجراء البحوث والدراسات الإجرائية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (المعلم)",
      "تحليل الوثائق (خطة التطوير المهني لمنسوبي المدرسة)"
    ]
  },
  "1-4-1-6": {
    procedures: [
      "نشر ثقافة التقويم الذاتي في المجتمع المدرسي والمحلي بأساليب متنوعة.",
      "تشكيل فريق التقويم الذاتي وفق المعايير المحددة في الدليل الإجرائي للتقويم الذاتي.",
      "تطبيق التقويم الذاتي المبني على المعايير المعتمدة من الهيئة.",
      "إشراك منسوبي/ات المدرسة في عمليات التقويم الذاتي ونتائجه.",
      "توثيق جميع إجراءات وعمليات التقويم الذاتي المطبق فعليًا."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "تحليل الوثائق"
    ]
  },
  "1-4-1-7": {
    procedures: [
      "وجود خطة التحسين في ضوء نتائج التقويم المدرسي.",
      "تنفيذ خطة التحسين وتوفر آلية لمتابعتها.",
      "التركيز على الأولويات في خطة التحسين وفقًا لنتائج التقويم الذاتي للمدرسة.",
      "تنفيذ برامج وأنشطة خطة التحسين.",
      "متابعة تنفيذ خطة التحسين بانتظام.",
      "تطوير خطة التحسين وإجراءات التنفيذ بشكل مستمر."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (الإدارة المدرسية)",
      "تحليل الوثائق (خطة متابعة مؤشرات الأداء وتقاريرها)"
    ]
  },
  "1-5-1-1": {
    procedures: [
      "تنفذ برامج توعوية بحقوق المتعلمين وسبل الحماية.",
      "توضح آليات الإبلاغ وطلب المساعدة داخل المدرسة وخارجها.",
      "تطبيق قواعد السلوك والمواظبة بما يضمن حقوق المتعلمين في المجتمع المدرسي.",
      "تطبيق إجراءات حماية شاملة تراعي جميع المتعلمين ومنهم ذوو الإعاقة والموهوبون.",
      "نشر الخطوط الساخنة: (مركز بلاغات العنف الأسري 1919، وخط مساندة الطفل 116111).",
      "توثيق الحقوق الأسرية والشخصية: الحق في الحضانة، والرعاية الأسرية.",
      "توفر حماية للمتعلم من الإساءة الجسدية، النفسية، الجنسية، والإهمال.",
      "ترصد وتعالج حالات الإهمال وتوفر الحاجات الأساسية لهم.",
      "تعمق الممارسات اليومية الدالة على المحافظة على حقوق المتعلمين وحمايتهم من الإيذاء."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (الإجراءات المتبعة لحماية المتعلم والحفاظ على حقوقه)"
    ]
  },
  "1-5-1-2": {
    procedures: ["لم ترد في الوثائق المرفقة إجراءات فرعية صريحة تحت هذا المؤشر"],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الموجه الطلابي)",
      "تحليل الوثائق (خطة التوجيه الطلابي وتقاريره)"
    ]
  },
  "2-1-1-1": {
    procedures: [
      "توفر مصادر تعلم تلبي احتياجات جميع المتعلمين.",
      "توفر مصادر وأنشطة متنوعة (صفية وغير صفية) تلبي احتياجات المتعلمين.",
      "توفر مصادر وأنشطة متنوعة تلبي احتياجات ذوي صعوبات التعلم وذوي الإعاقة.",
      "توفر مصادر وأنشطة متنوعة تلبي احتياجات سريعي التعلم والموهوبين.",
      "تتيح فرصًا متكافئة للمتعلمين في استخدام المصادر والأنشطة."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم)",
      "المقابلات (المتعلم)",
      "الملاحظة الصفية"
    ]
  },
  "2-1-1-2": {
    procedures: [
      "توفر أنشطة ومصادر لدعم تعلم محتوى المناهج (المعارف والمهارات والقيم).",
      "تتابع تنفيذ المناهج لتحقيق نواتج التعلم المستهدفة وفق الخطة الدراسية.",
      "تقدم التغذية الراجعة ومقترحات التحسين.",
      "تعمل على تأمين حصص للمعلم المتأخر في المنهج للسير وفق الخطة الدراسية."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم)",
      "المقابلات (المعلم)",
      "الملاحظة الصفية"
    ]
  },
  "2-1-1-3": {
    procedures: [
      "متنوعة تركز على المشاركة والتعلم النشط.",
      "تلائم قدرات المتعلمين وخبراتهم.",
      "تراعي الفروق الفردية بين المتعلمين.",
      "تتسق مع نواتج التعلم المستهدفة.",
      "تدعم تعلم ذوي صعوبات التعلم وذوي الإعاقة.",
      "تعلم سريعي التعلم والموهوبين."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم)",
      "المقابلات (المعلم)",
      "الملاحظة الصفية"
    ]
  },
  "2-1-1-4": {
    procedures: [
      "تضع إجراءات محددة لدعم التعلم الإلكتروني ضمن التعليم المدرسي اليومي.",
      "تضع إجراءات محددة للطوارئ (التعلم عن بعد)."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (الإدارة المدرسية)",
      "الملاحظة الصفية"
    ]
  },
  "2-1-1-6": {
    procedures: [
      "تنمية المهارات القرائية والعددية الأساسية لدى المتعلمين.",
      "تطبيق أنشطة تعلم تنمي مهارات القراءة والكتابة بطرق متنوعة.",
      "تطبيق أنشطة تعلم تنمي المهارات العددية (الحساب) بطرق متنوعة.",
      "وجود أنشطة علاجية وإثرائية متنوعة لتنمية مهارات القراءة والكتابة.",
      "وجود أنشطة علاجية وإثرائية متنوعة لتنمية المهارات العددية (الحساب).",
      "مشاركة المتعلمين في المسابقات الوطنية.",
      "مشاركة المتعلمين على المشاركة في المسابقات الدولية.",
      "تعميق الممارسات اليومية الدالة على تنمية المهارات القرائية والعددية الأساسية لدى المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم، الأسرة)",
      "المقابلات (المتعلم)",
      "الملاحظة الصفية",
      "تحليل الوثائق (عينة من ملفات إنجاز المتعلمين)"
    ]
  },
  "2-1-1-7": {
    procedures: [
      "تطبيق أنشطة تنمي مهارات التفكير العليا (الناقد والإبداعي وحل المشكلات) لدى المتعلمين.",
      "وجود أنشطة علاجية متنوعة لتنمية مهارات التفكير العليا.",
      "وجود أنشطة إثرائية متنوعة لتنمية مهارات التفكير العليا.",
      "دمج مهارات التفكير في الموضوعات الدراسية.",
      "تعميق الممارسات اليومية الداعمة لتنمية مهارات التفكير والبحث والابتكار لدى المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم، الأسرة)",
      "المقابلات (المتعلم)",
      "الملاحظة الصفية",
      "تحليل الوثائق (عينة من ملفات إنجاز المتعلمين)"
    ]
  },
  "2-1-1-9": {
    procedures: [
      "ينظم بيئة تعلم تعزز المهارات العاطفية والاجتماعية لدى المتعلمين.",
      "يقدم أنشطة تعلم تستهدف تنمية القدرة على التحكم في العواطف وضبط الانفعالات لدى جميع المتعلمين.",
      "ينظم بيئة تعلم تشجع العمل التعاوني.",
      "يشجع المتعلمين على المناقشة والحوار الفعال.",
      "ينظم بيئة تعلم تعزز الاحترام المتبادل بين المتعلمين."
    ],
    assessmentTools: [
      "المقابلات (المعلم)",
      "الملاحظة الصفية"
    ]
  },
  "2-2-1-1": {
    procedures: [
      "يستخدم أساليب وأدوات تقويم متنوعة تظهر التمايز في أداء المتعلمين.",
      "يوظف نتائج التقويم التشخيصي والتكويني؛ لتحديد الفجوات التعليمية وتصنيف المتعلمين إلى فئات الأداء الأساسية.",
      "يفعل التقويم الإلكتروني وأدوات التحليل الرقمية: لرصد مستويات الأداء واتجاهات التقدم.",
      "يعمق تطبيق الكشف عن مستويات أداء المتعلمين المختلفة من خلال ممارسات يومية مشاهدة."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم، الأسرة)",
      "تحليل الوثائق (عينة من نماذج تقويم أداء المتعلمين)",
      "الملاحظة الصفية"
    ]
  },
  "2-2-1-2": {
    procedures: [
      "يطبق أساليب تقويم متنوعة وفاعلة؛ لقياس نواتج التعلم المستهدفة في المناهج.",
      "يوظف نتائج التقويم؛ لتحديد نواتج التعلم غير المتحققة.",
      "ينفذ معالجات تعليمية مرتبطة بنواتج التعلم.",
      "مراجعة دورية لجودة التقويم ومدى ملاءمته لنواتج التعلم، وتطوير الأدوات والمعايير بناء على النتائج؛ لضمان التحسين المستمر لنواتج التعلم.",
      "يعمق الممارسات اليومية الدالة على تطبيق أساليب وأدوات لتقويم نواتج التعلم."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم، الأسرة)",
      "تحليل الوثائق (عينة من سجلات متابعة أداء المتعلمين)",
      "الملاحظة الصفية"
    ]
  },
  "2-2-1-3": {
    procedures: [
      "يحلل نتائج تقويم أداء المتعلمين، ويوظفها في تحسين تعلم المتعلمين بانتظام.",
      "يجمع بيانات حول تعلم المتعلمين بطرق متنوعة ويحلل.",
      "يفسر نتائج التقويم ويحدد أسباب الصعوبات التعليمية.",
      "يوظف نتائج التقويم في بناء خطط علاجية للمتعلمين، ويطور ممارساته التدريسية.",
      "يتابع تنفيذ الخطط العلاجية بانتظام."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "تحليل الوثائق",
      "المقابلات (المعلم)"
    ]
  },
  "2-2-1-4": {
    procedures: [
      "يقدم المعلم تغذية راجعة للمتعلمين بانتظام.",
      "يقدم المعلم تغذية راجعة فورية أثناء التعلم.",
      "تعزز التغذية الراجعة التعلم الذاتي لدى المتعلمين.",
      "يقدم المعلم تغذية راجعة بطرق متنوعة.",
      "يوظف المتعلم التغذية الراجعة في تحسين أدائهم بانتظام.",
      "تراعي التغذية الراجعة الفروق الفردية بين المتعلمين."
    ],
    assessmentTools: [
      "الاستبانات (المتعلم، الأسرة)",
      "تحليل الوثائق",
      "المقابلات (المعلم)"
    ]
  },
  "3-1-1-1": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-1-1-2": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-1-1-3": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-1-1-4": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-1-1-5": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-1-1-6": {
    procedures: [
      "دراسة وتحليل بطاقة نتائج نافس وتحديد الفجوات ووضع حلول عملية.",
      "تحديد المواد والمهارات في مجال القراءة والرياضيات والعلوم وتقديم الدعم اللازم لضمان تحسين المستوى التحصيلي للطالب.",
      "رفع مستوى استعداد الطلبة في المرحلة الثانوية لأداء اختبار القدرات والتحصيلي.",
      "تطبيق برامج داعمة لرفع نتائج الطلبة في اختبار القدرات والتحصيلي.",
      "تعميق الممارسات اليومية الدالة على تحسين مستوى المتعلمين في الاختبارات الوطنية."
    ],
    assessmentTools: [
      "نتائج الطلبة في نافس",
      "نتائج الطلبة في القدرات",
      "نتائج الطلبة في التحصيلي"
    ]
  },
  "3-2-1-2": {
    procedures: ["لم ترد في الوثائق المرفقة إجراءات فرعية صريحة تحت هذا المؤشر"],
    assessmentTools: [
      "ملاحظة بيئة التعلم"
    ]
  },
  "3-2-1-5": {
    procedures: [
      "نسبة المتعلمين الملتزمين بقواعد السلوك.",
      "نسبة المتعلمين الملتزمين المنتظمين في الحضور.",
      "تعزيز السلوك الإيجابي والانضباط المدرسي.",
      "رصد حالات الغياب والتأخر والمخالفات السلوكية.",
      "تعميق الممارسات اليومية الدالة على التزام المتعلمين بقواعد السلوك والانضباط."
    ],
    assessmentTools: [
      "الاستبانات (المعلم)",
      "المقابلات (المعلم)",
      "تحليل الوثائق (تقارير الانضباط المدرسي والسلوك)",
      "الملاحظة الصفية",
      "ملاحظة بيئة التعلم"
    ]
  },
  "3-2-1-6": {
    procedures: [
      "يظهر دافعية ذاتية للتعلم.",
      "يظهر القدرة على تحديد أهداف تعلمهم.",
      "يظهر القدرة على البحث عن المعلومات من مصادر تعلم موثوقية ومتنوعة.",
      "يطبق مهارات التعلم الذاتي.",
      "له ممارسات يومية دالة على الاستقلالية والقدرة على البحث والتعلم الذاتي خلال المواقف الصفية وغير الصفية."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (المعلم)",
      "الملاحظة الصفية"
    ]
  },
  "3-2-1-7": {
    procedures: [
      "اعتزازًا بثقافة المجتمع وتاريخه وتراثه.",
      "اعتزازًا بدينهم.",
      "فخرًا بلغتهم.",
      "احترامًا وتفهمًا للتنوع الثقافي للشعوب والثقافات الأخرى.",
      "ممارسات دالة على اعتزاز المتعلمين بثقافتهم واحترامًا للتنوع الثقافي في المجتمع."
    ],
    assessmentTools: [
      "الاستبانات (المعلم، المتعلم، الأسرة)",
      "المقابلات (المتعلم)",
      "ملاحظة بيئة التعلم",
      "الملاحظة الصفية"
    ]
  },
  "4-1-1-1": {
    procedures: [
      "دراسة بيئة المدرسة وتقديم المقترحات التطويرية اللازمة بشأنها.",
      "التواصل مع مقدمي الخدمات للمدرسة للحصول على أفضل خدمة ممكنة.",
      "الاهتمام بمرافق المدرسة وتنظيمها ونظافتها."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم",
      "تحليل الوثائق (نماذج التجهيزات وأدوات الأمن والسلامة)"
    ]
  },
  "4-1-1-2": {
    procedures: [
      "أثاث المبنى مناسب لخصائص المرحلة العمرية ومتطلباتها.",
      "سهولة التنقل بين مرافق المدرسة بما يتناسب مع خصائص المرحلة العمرية.",
      "ساحات المدرسة مناسبة لممارسة الأنشطة بما يتناسب مع خصائص المرحلة العمرية.",
      "تحديد المكان التربوي المناسب لذوي الإعاقة.",
      "إعداد استطلاعات قياس رضا المستفيدين من خدمات المدرسة."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم",
      "استبانة المعلم"
    ]
  },
  "4-1-1-3": {
    procedures: [
      "الفصول مناسبة لعدد المتعلمين.",
      "تجهيزات الفصول مناسبة للمتعلمين (الوسائل والأدوات والمواد اللازمة).",
      "الفصول تلبي احتياجات ذوي الإعاقة.",
      "حجم وطبيعة الطاولات والمقاعد في الفصول مناسب لخصائص المرحلة العمرية.",
      "تجهيزات المعامل مناسبة للمتعلمين، ومنهم ذوو الإعاقة (الوسائل والأدوات والمواد اللازمة).",
      "أجواء الفصول والمعامل مناسبة من حيث درجة الحرارة أو البرودة والتهوية والإضاءة."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم",
      "استبانات (المعلم، المتعلم)"
    ]
  },
  "4-1-1-4": {
    procedures: [
      "المساحة المخصصة للمقصف المدرسي وأماكن تناول الطعام تلبي احتياجات المتعلمين ومنهم ذوو الإعاقة.",
      "ساحة الاصطفاف الصباحي مناسبة للمتعلمين.",
      "دورات المياه مناسبة للمتعلمين ومنهم ذوو الإعاقة.",
      "توافر أماكن لممارسة الأنشطة تلائم المرحلة العمرية للمتعلمين ومنهم ذوو الإعاقة."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم",
      "استبانة المعلم"
    ]
  },
  "4-2-1-1": {
    procedures: [
      "وجود تقرير الأمن والسلامة ساري العمل به.",
      "وجود الشهادات الصحية للعاملين سارية المفعول.",
      "تنفيذ برامج وأنشطة متعلقة بالأمن والسلامة.",
      "تحديد احتياجات المدرسة من أجهزة الأمن والسلامة.",
      "وجود سجل لتنظيم دخول الزوار للمدرسة.",
      "تدريب منسوبي المدرسة على خطة الإخلاء في الحالات الطارئة.",
      "سلامة مخارج الطوارئ ومسارات ذوي الإعاقة واللوحات الإرشادية وطفايات الحريق وكواشف الدخان وأجهزة الإنذار."
    ],
    assessmentTools: [
      "ملاحظة بيئة التعلم",
      "استبانة الأسرة",
      "تحليل الوثائق (خطة الأمن والسلامة وخطط الإخلاء وتقويمها)"
    ]
  },
  "4-2-1-2": {
    procedures: [
      "توافر خطط لأعمال الصيانة الوقائية والعلاجية بانتظام.",
      "رفع بلاغات الدعم الفني والتواصل مع الجهات الخدمية لمعالجة الخلل.",
      "تنفيذ برامج توعوية داخل المدرسة للمحافظة على الممتلكات العامة والمرافق.",
      "وجود تقارير دورية لواقع مرافق وتجهيزات المدرسة، تتضمن المقترحات والإجراءات التحسينية."
    ],
    assessmentTools: [
      "استبانة المعلم",
      "تحليل الوثائق",
      "ملاحظة بيئة التعلم"
    ]
  },
  "4-2-1-3": {
    procedures: [
      "نظافة الفصول / الممرات والساحات / نظافة المعامل.",
      "نظافة المقصف المدرسي وأماكن الجلوس.",
      "نظافة دورات المياه / نظافة الأثاث والتجهيزات.",
      "الحاويات كافية وموزعة في مختلف أماكن المدرسة.",
      "وجود استمارة متابعة وتقييم نظافة دورات المياه."
    ],
    assessmentTools: [
      "استبانات (المعلم، المتعلم)",
      "ملاحظة بيئة التعلم"
    ]
  }
};

const allIndicatorGuides = { ...indicatorGuides, ...indicatorGuideOverrides };

function makeIndicators(standardId) {
  return indicatorTexts[standardId].map(([id, title]) => {
    const guide = allIndicatorGuides[id];
    return {
      id,
      title,
      evidenceGuide: guide?.procedures ? [...guide.procedures] : [...evidenceTemplate],
      documentsGuide: guide?.assessmentTools ? [...guide.assessmentTools] : [...documentsTemplate]
    };
  });
}

const domains = [
  {
    id: 1,
    name: "الإدارة المدرسية",
    standards: [
      { id: "1-1", name: "التخطيط", indicators: makeIndicators("1-1") },
      { id: "1-2", name: "قيادة العملية التعليمية", indicators: makeIndicators("1-2") },
      { id: "1-3", name: "المجتمع المدرسي", indicators: makeIndicators("1-3") },
      { id: "1-4", name: "التطوير المؤسسي", indicators: makeIndicators("1-4") },
      { id: "1-5", name: "حقوق المتعلم وحمايته", indicators: makeIndicators("1-5") }
    ]
  },
  {
    id: 2,
    name: "التعليم والتعلم",
    standards: [
      { id: "2-1", name: "بناء خبرات التعلم", indicators: makeIndicators("2-1") },
      { id: "2-2", name: "تقويم التعلم", indicators: makeIndicators("2-2") }
    ]
  },
  {
    id: 3,
    name: "نواتج التعلم",
    standards: [
      { id: "3-1", name: "التحصيل التعليمي", indicators: makeIndicators("3-1") },
      { id: "3-2", name: "التطور الشخصي والصحي", indicators: makeIndicators("3-2") }
    ]
  },
  {
    id: 4,
    name: "البيئة المدرسية",
    standards: [
      { id: "4-1", name: "المبنى المدرسي", indicators: makeIndicators("4-1") },
      { id: "4-2", name: "الأمن والسلامة", indicators: makeIndicators("4-2") }
    ]
  }
];

const storageKey = "school-quality-tracker";
const persisted = JSON.parse(localStorage.getItem(storageKey) || "{}");
const state = {
  domain: null,
  standard: null,
  selectedIndicator: null,
  checks: persisted.checks || {}
};

const dashboardEl = document.getElementById("dashboard");
const backupPanelEl = document.getElementById("backup-panel");
const breadcrumbsEl = document.getElementById("breadcrumbs");
const listViewEl = document.getElementById("list-view");
const detailViewEl = document.getElementById("detail-view");

function save() {
  localStorage.setItem(storageKey, JSON.stringify({ checks: state.checks }));
}

function createBackupPayload() {
  return {
    version: 1,
    app: "school-quality-tracker",
    exportedAt: new Date().toISOString(),
    checks: state.checks
  };
}

function normalizeChecks(rawChecks) {
  const normalized = {};
  if (!rawChecks || typeof rawChecks !== "object") return normalized;

  for (const [indicatorId, value] of Object.entries(rawChecks)) {
    const evidence = Array.isArray(value?.evidence) ? [...new Set(value.evidence.filter(Number.isInteger))] : [];
    const documents = Array.isArray(value?.documents) ? [...new Set(value.documents.filter(Number.isInteger))] : [];
    normalized[indicatorId] = {
      evidence: evidence.sort((a, b) => a - b),
      documents: documents.sort((a, b) => a - b)
    };
  }

  return normalized;
}

function restoreFromBackupPayload(payload) {
  if (!payload || typeof payload !== "object" || !payload.checks || typeof payload.checks !== "object") {
    throw new Error("ملف النسخة الاحتياطية غير صالح.");
  }

  state.checks = normalizeChecks(payload.checks);
  save();
  render();
}

function downloadBackupFile() {
  const payload = createBackupPayload();
  const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const link = document.createElement("a");
  const date = new Date().toISOString().slice(0, 10);
  link.href = url;
  link.download = `school-quality-backup-${date}.json`;
  document.body.appendChild(link);
  link.click();
  link.remove();
  URL.revokeObjectURL(url);
}

function renderBackupPanel() {
  backupPanelEl.innerHTML = `
    <div class="backup-header">
      <h2>حفظ ومشاركة التقدم</h2>
      <p class="backup-note">جميع أدوات المنصة في مكان واحد — تنقل بين الصفحات، أنشئ التقارير، واحفظ بياناتك بأمان مع فريقك.</p>
    </div>

    <div class="backup-groups">
      <div class="backup-group backup-group-top">
        <p class="backup-group-title"><span class="group-title-icon">📑</span> التقارير والتنقل</p>
        <div class="backup-actions backup-actions-top">
          <button class="backup-btn backup-btn-nav" data-backup="school-info">
            <span class="btn-icon">⚙️</span>
            <span>بيانات المدرسة والفريق</span>
          </button>
          <a class="backup-btn backup-btn-nav" href="report.html">
            <span class="btn-icon">📋</span>
            <span>التقرير المستقل</span>
          </a>
          <a class="backup-btn backup-btn-nav" href="progress-report.html">
            <span class="btn-icon">📊</span>
            <span>تقرير التقدم والإنجاز (PDF)</span>
          </a>
          <button class="backup-btn backup-btn-nav" data-backup="report">
            <span class="btn-icon">🖨️</span>
            <span>تقرير الإنجاز الفوري (A4)</span>
          </button>
        </div>
      </div>

      <div class="backup-group backup-group-bottom">
        <p class="backup-group-title"><span class="group-title-icon">🔒</span> حفظ البيانات واستعادتها</p>
        <div class="backup-actions backup-actions-bottom">
          <button class="backup-btn backup-btn-primary" data-backup="download">
            <span class="btn-icon">💾</span>
            <span>نسخة احتياطية</span>
          </button>
          <label class="backup-btn backup-btn-outline" for="backup-file-input">
            <span class="btn-icon">📁</span>
            <span>استعادة نسخة من ملف</span>
          </label>
          <button class="backup-btn backup-btn-danger" data-backup="clear">
            <span class="btn-icon">🗑</span>
            <span>مسح البيانات بالكامل</span>
          </button>
          <input id="backup-file-input" type="file" accept="application/json" hidden />
        </div>
      </div>
    </div>

    <p id="backup-status" class="backup-status" aria-live="polite"></p>
  `;

  const statusEl = backupPanelEl.querySelector("#backup-status");

  backupPanelEl.querySelector('[data-backup="school-info"]')?.addEventListener("click", () => {
    if (typeof window.openSchoolInfoModal === "function") {
      window.openSchoolInfoModal();
    }
  });

  backupPanelEl.querySelector('[data-backup="download"]')?.addEventListener("click", () => {
    downloadBackupFile();
    statusEl.textContent = "✅ تم تنزيل النسخة الاحتياطية بنجاح. شارك الملف مع الفريق لاستعادة نفس التقدم.";
  });

  backupPanelEl.querySelector("#backup-file-input")?.addEventListener("change", async (event) => {
    const [file] = event.target.files || [];
    if (!file) return;

    try {
      const content = await file.text();
      const payload = JSON.parse(content);
      restoreFromBackupPayload(payload);
      statusEl.textContent = "✅ تم استعادة النسخة الاحتياطية وتحديث جميع المؤشرات.";
    } catch (error) {
      statusEl.textContent = `❌ فشل الاستعادة: ${error.message || "تحقق من صحة الملف"}`;
    } finally {
      event.target.value = "";
    }
  });

  backupPanelEl.querySelector('[data-backup="report"]')?.addEventListener("click", () => {
    const opened = openPrintableReport();
    if (opened) {
      statusEl.textContent = "✅ تم فتح التقرير. استخدم الطباعة للحفظ بصيغة PDF.";
    } else {
      statusEl.textContent = "⚠️ تعذر فتح نافذة جديدة؛ تم فتح التقرير في نفس الصفحة.";
    }
  });

  backupPanelEl.querySelector('[data-backup="clear"]')?.addEventListener("click", () => {
    openClearDataModal();
  });
}

function clearAllData() {
  localStorage.removeItem(storageKey);
  localStorage.removeItem("school-quality-tracker");
  localStorage.removeItem("accreditation-checklist-v3");
  state.checks = {};
  closeClearDataModal();
  render();
}

function openClearDataModal() {
  const overlay = document.getElementById("cdOverlay");
  if (overlay) overlay.classList.add("cd-active");
}

function closeClearDataModal() {
  const overlay = document.getElementById("cdOverlay");
  if (overlay) overlay.classList.remove("cd-active");
}

function flattenIndicators() {
  return domains.flatMap((d) =>
    d.standards.flatMap((s) =>
      s.indicators.map((i) => ({ ...i, domainName: d.name, standardName: s.name }))
    )
  );
}

function findIndicatorById(indicatorId) {
  for (const domain of domains) {
    for (const standard of domain.standards) {
      const indicator = standard.indicators.find((item) => item.id === indicatorId);
      if (indicator) return indicator;
    }
  }
  return null;
}

function completionRate(indicator) {
  const totalItems = indicator.evidenceGuide.length + indicator.documentsGuide.length;
  if (totalItems === 0) return 0;
  return Math.min(100, Math.round((providedCount(indicator.id) / totalItems) * 100));
}

function statusFromCompletion(rate) {
  if (rate === 0) return "لم يبدأ";
  if (rate < 90) return "قيد التنفيذ";
  if (rate < 100) return "مكتملة";
  return "منجز";
}

function statusBadge(id) {
  const indicator = findIndicatorById(id);
  if (!indicator) return "لم يبدأ";
  return statusFromCompletion(completionRate(indicator));
}

function standardStats(standard) {
  const stats = { total: standard.indicators.length, done: 0, inProgress: 0, pending: 0 };

  standard.indicators.forEach((indicator) => {
    const status = statusFromCompletion(completionRate(indicator));
    if (status === "منجز" || status === "مكتملة") stats.done += 1;
    else if (status === "قيد التنفيذ") stats.inProgress += 1;
    else stats.pending += 1;
  });

  const status = stats.done === stats.total ? "done" : stats.inProgress > 0 || stats.done > 0 ? "in-progress" : "pending";
  return { ...stats, status };
}

function calcLevel(count) {
  if (count <= 2) return { cls: "level-low", text: "🔴 متحقق بدرجة منخفضة" };
  if (count <= 4) return { cls: "level-med", text: "🟠 متحقق بدرجة متوسطة" };
  if (count === 5) return { cls: "level-high", text: "🟢 متحقق بدرجة مرتفعة" };
  return { cls: "level-vhigh", text: "🔵 متحقق بدرجة مرتفعة جداً" };
}

function levelCardMeta(level) {
  const label = level.text.replace(/^[^\s]+\s*/, "");
  if (level.cls === "level-low") return { label, cls: "indicator-level-low", dot: "dot-low" };
  if (level.cls === "level-med") return { label, cls: "indicator-level-med", dot: "dot-med" };
  if (level.cls === "level-high") return { label, cls: "indicator-level-high", dot: "dot-high" };
  return { label, cls: "indicator-level-vhigh", dot: "dot-vhigh" };
}

function getChecks(indicatorId) {
  return state.checks[indicatorId] || { evidence: [], documents: [] };
}

function getValidChecks(indicatorId) {
  const indicator = findIndicatorById(indicatorId);
  const checks = getChecks(indicatorId);
  if (!indicator) return { evidence: [], documents: [] };

  const validEvidence = (checks.evidence || []).filter(
    (idx) => Number.isInteger(idx) && idx >= 0 && idx < indicator.evidenceGuide.length
  );
  const validDocuments = (checks.documents || []).filter(
    (idx) => Number.isInteger(idx) && idx >= 0 && idx < indicator.documentsGuide.length
  );

  return { evidence: validEvidence, documents: validDocuments };
}

function providedCount(indicatorId) {
  const c = getValidChecks(indicatorId);
  return (c.evidence?.length || 0) + (c.documents?.length || 0);
}

function renderDashboard() {
  const all = flattenIndicators();
  const total = all.length;
  const done = all.filter((i) => statusBadge(i.id) === "منجز").length;
  const almostDone = all.filter((i) => statusBadge(i.id) === "مكتملة").length;
  const inProgress = all.filter((i) => statusBadge(i.id) === "قيد التنفيذ").length;
  const pending = all.filter((i) => statusBadge(i.id) === "لم يبدأ").length;
  const progress = total ? Math.round(all.reduce((sum, indicator) => sum + completionRate(indicator), 0) / total) : 0;

  dashboardEl.innerHTML = `
    <div class="stats">
      <div class="stat-box"><h3>${total}</h3><p>إجمالي المؤشرات</p></div>
      <div class="stat-box"><h3>${done}</h3><p>منجز</p></div>
      <div class="stat-box"><h3>${almostDone}</h3><p>مكتملة (90%+)</p></div>
      <div class="stat-box"><h3>${inProgress}</h3><p>قيد التنفيذ</p></div>
      <div class="stat-box"><h3>${pending}</h3><p>لم يبدأ</p></div>
      <div class="gauge">
        <p>نسبة الإنجاز الكلية</p>
        <div class="bar"><span style="width:${progress}%"></span></div>
        <strong>${progress}%</strong>
      </div>
    </div>
  `;
}

function renderBreadcrumbs() {
  const crumbs = [
    `<button data-step="home">المجالات</button>`,
    state.domain ? `<button data-step="domain">${state.domain.name}</button>` : "",
    state.standard ? `<span>${state.standard.name}</span>` : ""
  ].filter(Boolean);
  breadcrumbsEl.innerHTML = crumbs.join("<i>←</i>");

  breadcrumbsEl.querySelector('[data-step="home"]')?.addEventListener("click", () => {
    state.domain = null;
    state.standard = null;
    state.selectedIndicator = null;
    render();
  });

  breadcrumbsEl.querySelector('[data-step="domain"]')?.addEventListener("click", () => {
    state.standard = null;
    state.selectedIndicator = null;
    render();
  });
}

function renderDomains() {
  listViewEl.innerHTML = `
    <h2>الطبقة الأولى: المجالات الرئيسية</h2>
    <div class="grid">${domains
      .map(
        (d) => `<article class="item-card">
          <h3>${d.name}</h3>
          <p>${d.standards.length} معيار</p>
          <button data-domain="${d.id}">عرض المعايير</button>
        </article>`
      )
      .join("")}</div>`;

  listViewEl.querySelectorAll("[data-domain]").forEach((btn) => {
    btn.addEventListener("click", () => {
      state.domain = domains.find((d) => d.id === Number(btn.dataset.domain));
      state.standard = null;
      state.selectedIndicator = null;
      render();
    });
  });
}

function renderStandards() {
  listViewEl.innerHTML = `
    <h2>الطبقة الثانية: معايير مجال ${state.domain.name}</h2>
    <div class="grid">${state.domain.standards
      .map((s) => {
        const stats = standardStats(s);
        const statusText = stats.status === "done" ? "مكتمل" : stats.status === "in-progress" ? "قيد التنفيذ" : "لم يبدأ";
        return `<article class="item-card standard-card">
          <h3>
            <span class="standard-status-dot standard-status-${stats.status}" title="${statusText}"></span>
            ${s.name}
          </h3>
          <p>${stats.total} مؤشر</p>
          <div class="standard-stats">
            <span class="standard-stat">الإجمالي: <strong>${stats.total}</strong></span>
            <span class="standard-stat">المكتمل: <strong>${stats.done}</strong></span>
            <span class="standard-stat">غير المكتمل: <strong>${stats.inProgress}</strong></span>
            <span class="standard-stat">لم يبدأ: <strong>${stats.pending}</strong></span>
          </div>
          <button data-standard="${s.id}">عرض المؤشرات</button>
        </article>`;
      })
      .join("")}</div>`;

  listViewEl.querySelectorAll("[data-standard]").forEach((btn) => {
    btn.addEventListener("click", () => {
      state.standard = state.domain.standards.find((s) => s.id === btn.dataset.standard);
      state.selectedIndicator = null;
      render();
    });
  });
}

function renderIndicators() {
  const selectedId = state.selectedIndicator?.id;
  const indicators = state.standard.indicators;
  const selectedIndex = indicators.findIndex((indicator) => indicator.id === selectedId);
  const isFocusedMode = selectedIndex !== -1;

  const indicatorCardTemplate = (i) => {
    const score = providedCount(i.id);
    const level = calcLevel(score);
    const levelMeta = levelCardMeta(level);
    const completion = completionRate(i);
    const status = statusBadge(i.id);

    return `<article class="item-card">
      <section class="indicator-card-head">
        <p class="code indicator-code">${i.id}</p>
        <h3 class="indicator-heading">${i.title}</h3>
      </section>
      <section class="indicator-card-foot">
        <div class="indicator-progress-row">
          <span class="indicator-chip indicator-chip-status">${status}</span>
          <span class="indicator-chip indicator-chip-label">نسبة الإنجاز</span>
          <span class="indicator-chip indicator-chip-value">%${completion}</span>
        </div>
        <div class="indicator-level ${levelMeta.cls}">
          <span class="indicator-level-text">${levelMeta.label}</span>
          <span class="indicator-dot ${levelMeta.dot}"></span>
        </div>
        <button class="indicator-action" data-indicator="${i.id}">دليل قائمة التحقق للمؤشر</button>
      </section>
    </article>`;
  };

  if (isFocusedMode) {
    const selectedIndicator = indicators[selectedIndex];
    const previous = indicators[selectedIndex - 1];
    const next = indicators[selectedIndex + 1];

    listViewEl.innerHTML = `
      <h2>الطبقة الثالثة: مؤشرات معيار ${state.standard.name}</h2>
      <section class="focus-toolbar">
        <div class="focus-title-wrap">
          <span class="focus-badge">وضع التركيز</span>
          <p>تعمل الآن على مؤشر واحد فقط لسرعة الإنجاز والدقة.</p>
        </div>
        <div class="focus-actions">
          <button class="focus-btn focus-btn-outline" data-focus="back-all">العودة لعرض جميع المؤشرات</button>
          <button class="focus-btn" data-focus="prev" ${!previous ? "disabled" : ""}>المؤشر السابق</button>
          <button class="focus-btn" data-focus="next" ${!next ? "disabled" : ""}>المؤشر التالي</button>
        </div>
      </section>
      <div class="grid indicators-grid focused-grid">${indicatorCardTemplate(selectedIndicator)}</div>`;

    listViewEl.querySelector('[data-focus="back-all"]')?.addEventListener("click", () => {
      state.selectedIndicator = null;
      render();
    });

    listViewEl.querySelector('[data-focus="prev"]')?.addEventListener("click", () => {
      if (!previous) return;
      state.selectedIndicator = previous;
      render();
    });

    listViewEl.querySelector('[data-focus="next"]')?.addEventListener("click", () => {
      if (!next) return;
      state.selectedIndicator = next;
      render();
    });
  } else {
    listViewEl.innerHTML = `
      <h2>الطبقة الثالثة: مؤشرات معيار ${state.standard.name}</h2>
      <div class="grid indicators-grid">${indicators.map((i) => indicatorCardTemplate(i)).join("")}</div>`;
  }

  listViewEl.querySelectorAll("[data-indicator]").forEach((btn) => {
    btn.addEventListener("click", () => {
      state.selectedIndicator = state.standard.indicators.find((i) => i.id === btn.dataset.indicator);
      render();
    });
  });
}

function toggleCheck(indicatorId, type, index) {
  const record = getChecks(indicatorId);
  const set = new Set(record[type] || []);
  if (set.has(index)) set.delete(index);
  else set.add(index);
  state.checks[indicatorId] = { ...record, [type]: [...set].sort((a, b) => a - b) };
  save();
  renderIndicators();
  renderDetail();
}

function listChecks(items, selected, type, indicatorId) {
  return items
    .map(
      (item, idx) => `<label class="check-item ${selected.includes(idx) ? "active" : ""}">
        <input type="checkbox" data-check="${type}" data-idx="${idx}" ${selected.includes(idx) ? "checked" : ""}/>
        <span>${item}</span>
      </label>`
    )
    .join("");
}

function renderDetail() {
  if (!state.selectedIndicator) {
    detailViewEl.hidden = true;
    return;
  }
  const i = state.selectedIndicator;
  const checks = getValidChecks(i.id);
  const score = providedCount(i.id);
  const level = calcLevel(score);
  const progress = completionRate(i);

  detailViewEl.hidden = false;
  detailViewEl.innerHTML = `
    <div class="detail-progress-wrap" aria-label="نسبة إنجاز المؤشر">
      <div class="indicator-progress-summary">
        <div class="indicator-progress-track"><span style="width:${progress}%"></span></div>
        <strong class="indicator-progress-value">%${progress}</strong>
      </div>
    </div>
    <h2>${i.id}</h2>
    <p class="indicator-title">${i.title}</p>
    <div class="evidence-head">
      <span>عدد الأدلة المتوفرة: <strong>${score}</strong></span>
      <span class="pill ${level.cls}">${level.text}</span>
    </div>

    <section class="checklist-box">
      <h3>الإجراءات</h3>
      <div class="checklist" data-wrap="evidence">${listChecks(i.evidenceGuide, checks.evidence || [], "evidence", i.id)}</div>
    </section>

    <section class="checklist-box">
      <h3>أدوات التقييم</h3>
      <div class="checklist" data-wrap="documents">${listChecks(i.documentsGuide, checks.documents || [], "documents", i.id)}</div>
    </section>
  `;

  detailViewEl.querySelectorAll("input[data-check]").forEach((cb) => {
    cb.addEventListener("change", () => toggleCheck(i.id, cb.dataset.check, Number(cb.dataset.idx)));
  });
}



function reportIndicatorMeta(indicator, domainName, standardName) {
  const provided = providedCount(indicator.id);
  const total = indicator.evidenceGuide.length + indicator.documentsGuide.length;
  const rate = completionRate(indicator);
  const status = statusFromCompletion(rate);
  return { id: indicator.id, title: indicator.title, domainName, standardName, provided, total, rate, status };
}

function getReportData() {
  const indicators = domains.flatMap((domain) =>
    domain.standards.flatMap((standard) =>
      standard.indicators.map((indicator) => reportIndicatorMeta(indicator, domain.name, standard.name))
    )
  );

  const totalIndicators = indicators.length;
  const done = indicators.filter((item) => item.status === "منجز").length;
  const almostDone = indicators.filter((item) => item.status === "مكتملة").length;
  const inProgress = indicators.filter((item) => item.status === "قيد التنفيذ").length;
  const pending = indicators.filter((item) => item.status === "لم يبدأ").length;
  const overall = totalIndicators
    ? Math.round(indicators.reduce((sum, item) => sum + item.rate, 0) / totalIndicators)
    : 0;

  const byStandard = [];
  domains.forEach((domain) => {
    domain.standards.forEach((standard) => {
      const rows = standard.indicators.map((indicator) => reportIndicatorMeta(indicator, domain.name, standard.name));
      const avg = rows.length ? Math.round(rows.reduce((sum, item) => sum + item.rate, 0) / rows.length) : 0;
      byStandard.push({ domainName: domain.name, standardName: standard.name, avg, rows });
    });
  });

  return {
    generatedAt: new Date().toLocaleString("ar-SA"),
    totalIndicators,
    done,
    almostDone,
    inProgress,
    pending,
    overall,
    byStandard
  };
}

function reportBadgeCls(status) {
  if (status === "منجز") return "r-badge done";
  if (status === "مكتملة") return "r-badge almost";
  if (status === "قيد التنفيذ") return "r-badge progress";
  return "r-badge pending";
}

function openPrintableReport() {
  const data = getReportData();
  const moeLogoUrl = "https://raw.githubusercontent.com/bndrjj/selfereoprt/main/%D9%88%D8%B2%D8%A7%D8%B1%D8%A9%20%D8%A7%D9%84%D8%AA%D8%B9%D9%84%D9%8A%D9%85.png";

  const standardSections = data.byStandard
    .map((group) => {
      const rows = group.rows
        .map(
          (row) => `<tr>
            <td>${row.id}</td>
            <td>${row.title}</td>
            <td><span class="${reportBadgeCls(row.status)}">${row.status}</span></td>
            <td>${row.provided}/${row.total}</td>
            <td>${row.rate}%</td>
          </tr>`
        )
        .join("");

      return `<section class="r-standard">
        <h3>${group.domainName} / ${group.standardName}</h3>
        <p class="r-standard-rate">نسبة إنجاز المعيار: <strong>${group.avg}%</strong></p>
        <table>
          <thead>
            <tr>
              <th>رقم المؤشر</th>
              <th>المؤشر</th>
              <th>الحالة</th>
              <th>المتحقق</th>
              <th>نسبة الإنجاز</th>
            </tr>
          </thead>
          <tbody>${rows}</tbody>
        </table>
      </section>`;
    })
    .join("");

  const reportHtml = `<!doctype html>
  <html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <title>تقرير إنجاز المؤشرات</title>
    <style>
      @page { size: A4; margin: 12mm; }
      * { box-sizing: border-box; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
      body { margin: 0; font-family: "Tajawal", Arial, sans-serif; color: #123; background: #fff; }
      .r-wrap { width: 100%; }
      .r-header { display: flex; justify-content: space-between; align-items: center; gap: 16px; border: 2px solid #1f8f6a; border-radius: 12px; padding: 14px; margin-bottom: 14px; }
      .r-logo { width: 120px; height: auto; }
      .r-klisha h1 { margin: 0; font-size: 22px; color: #0f5f47; }
      .r-klisha p { margin: 4px 0 0; font-size: 13px; color: #345; }
      .r-summary { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-bottom: 14px; }
      .r-card { border: 1px solid #d8e5df; border-radius: 10px; padding: 8px; text-align: center; background: #f7fbf9; }
      .r-card strong { display: block; font-size: 20px; color: #0f5f47; }
      .r-card span { font-size: 12px; color: #445; }
      .r-progress { margin-bottom: 14px; border: 1px solid #d8e5df; border-radius: 10px; padding: 8px; }
      .r-bar { background: #e8f2ee; height: 12px; border-radius: 99px; overflow: hidden; }
      .r-bar > span { display: block; height: 100%; background: linear-gradient(90deg, #1f8f6a, #46b58f); width: ${data.overall}%; }
      .r-progress p { margin: 0 0 8px; font-size: 13px; }
      .r-standard { border: 1px solid #e0ebe6; border-radius: 10px; padding: 10px; margin-bottom: 10px; break-inside: avoid; }
      .r-standard h3 { margin: 0 0 4px; color: #0f5f47; font-size: 16px; }
      .r-standard-rate { margin: 0 0 8px; font-size: 12px; color: #456; }
      table { width: 100%; border-collapse: collapse; font-size: 12px; }
      th, td { border: 1px solid #dde8e2; padding: 6px; vertical-align: top; }
      th { background: #f0f7f4; }
      .r-badge { display: inline-block; padding: 2px 8px; border-radius: 999px; font-size: 11px; }
      .r-badge.done { background: #d8f2e4; color: #0f7a4f; }
      .r-badge.almost { background: #dbeeff; color: #1b5c9a; }
      .r-badge.progress { background: #fff1cf; color: #8a6300; }
      .r-badge.pending { background: #ffe0e0; color: #a53434; }
      .r-footer { margin-top: 10px; font-size: 11px; color: #667; text-align: center; }
    </style>
  </head>
  <body>
    <main class="r-wrap">
      <header class="r-header">
        <img class="r-logo" src="${moeLogoUrl}" alt="شعار وزارة التعليم" />
        <div class="r-klisha">
          <h1>وزارة التعليم السعودية - تقرير إنجاز المؤشرات</h1>
          <p>تاريخ إنشاء التقرير: ${data.generatedAt}</p>
          <p>التقرير مرتبط مباشرة ببيانات الإنجاز المدخلة في المنصة.</p>
        </div>
      </header>

      <section class="r-summary">
        <div class="r-card"><strong>${data.totalIndicators}</strong><span>إجمالي المؤشرات</span></div>
        <div class="r-card"><strong>${data.done}</strong><span>منجز</span></div>
        <div class="r-card"><strong>${data.almostDone}</strong><span>مكتملة</span></div>
        <div class="r-card"><strong>${data.inProgress}</strong><span>قيد التنفيذ</span></div>
        <div class="r-card"><strong>${data.pending}</strong><span>لم يبدأ</span></div>
        <div class="r-card"><strong>${data.overall}%</strong><span>الإنجاز الكلي</span></div>
      </section>

      <section class="r-progress">
        <p>مؤشر الإنجاز الكلي</p>
        <div class="r-bar"><span></span></div>
      </section>

      ${standardSections}

      <footer class="r-footer">يمكن طباعة هذه الصفحة مباشرة على مقاس A4 أو حفظها بصيغة PDF من نافذة الطباعة.</footer>
    </main>
    <script>window.addEventListener('load', () => setTimeout(() => window.print(), 500));</script>
  </body>
  </html>`;

  const blob = new Blob([reportHtml], { type: "text/html;charset=utf-8" });
  const reportUrl = URL.createObjectURL(blob);

  const reportWindow = window.open(reportUrl, "_blank", "noopener,noreferrer");
  if (reportWindow) {
    setTimeout(() => URL.revokeObjectURL(reportUrl), 60_000);
    return true;
  }

  window.location.href = reportUrl;
  setTimeout(() => URL.revokeObjectURL(reportUrl), 60_000);
  return false;
}
function render() {
  renderDashboard();
  renderBackupPanel();
  renderBreadcrumbs();

  if (!state.domain) {
    renderDomains();
    detailViewEl.hidden = true;
    return;
  }
  if (!state.standard) {
    renderStandards();
    detailViewEl.hidden = true;
    return;
  }
  renderIndicators();
  renderDetail();
}

render();
