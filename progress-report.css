/* ===================================================================
   تقرير التقدم والإنجاز - تنسيق احترافي لمقاس A4
   =================================================================== */

:root {
  --pr-primary: #0c6b60;
  --pr-primary-dark: #094d45;
  --pr-primary-light: #1a8f82;
  --pr-accent: #d4af37;
  --pr-accent-light: #f5e6b8;
  --pr-bg: #ffffff;
  --pr-bg-alt: #f7faf9;
  --pr-bg-section: #f0f7f6;
  --pr-text: #1a2e2c;
  --pr-text-muted: #5a7370;
  --pr-border: #c8dcd9;
  --pr-border-light: #e2edeb;
  --pr-completed: #15803d;
  --pr-completed-bg: #dcfce7;
  --pr-inprogress: #b45309;
  --pr-inprogress-bg: #fef3c7;
  --pr-notstarted: #b91c1c;
  --pr-notstarted-bg: #fee2e2;
  --pr-ring-size: 180px;
}

/* ===== Reset & Base ===== */
*, *::before, *::after { box-sizing: border-box; }
body {
  margin: 0;
  padding: 0;
  font-family: 'Cairo', 'Tajawal', sans-serif;
  background: #e8eeed;
  color: var(--pr-text);
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* ===== Toolbar (no-print) ===== */
.toolbar {
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: linear-gradient(135deg, var(--pr-primary-dark), var(--pr-primary));
  padding: 10px 24px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.15);
}
.toolbar-right, .toolbar-left { display: flex; gap: 8px; align-items: center; }
.tool-btn {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 8px 18px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.25);
  background: rgba(255,255,255,0.1);
  color: #fff;
  font-weight: 700;
  font-size: 14px;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.2s;
  font-family: inherit;
}
.tool-btn:hover { background: rgba(255,255,255,0.25); }
.tool-btn.primary {
  background: var(--pr-accent);
  color: var(--pr-primary-dark);
  border-color: var(--pr-accent);
  font-weight: 800;
}
.tool-btn.primary:hover { background: #e0be4e; }

/* ===== Report Page ===== */
.report-page {
  max-width: 210mm;
  margin: 0 auto;
  background: var(--pr-bg);
  padding: 28px 32px;
  min-height: 100vh;
}

/* ===== Letterhead ===== */
.letterhead {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  align-items: center;
  gap: 16px;
  padding-bottom: 16px;
}
.lh-col { min-height: 100px; }
.lh-right { text-align: right; }
.lh-center { display: flex; align-items: center; justify-content: center; }
.lh-left { text-align: left; }
.lh-logo {
  width: 180px;
  max-height: 140px;
  object-fit: contain;
}
.lh-line {
  margin: 0 0 4px;
  font-size: 14px;
  font-weight: 700;
  color: var(--pr-primary-dark);
  line-height: 1.5;
}
.lh-line.lh-big {
  font-size: 17px;
  font-weight: 900;
  color: var(--pr-primary-dark);
}
.lh-date {
  font-size: 13px;
  color: var(--pr-text-muted);
  font-weight: 600;
}
.lh-hijri {
  font-size: 12px;
  color: var(--pr-text-muted);
  font-weight: 500;
}
.lh-divider {
  height: 4px;
  border-radius: 2px;
  background: linear-gradient(90deg, var(--pr-accent), var(--pr-primary), var(--pr-accent));
  margin-bottom: 20px;
}

/* ===== Section Headings ===== */
.section-heading {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 24px 0 14px;
  padding: 10px 16px;
  background: linear-gradient(135deg, var(--pr-primary-dark), var(--pr-primary));
  color: #fff;
  font-size: 16px;
  font-weight: 800;
  border-radius: 8px;
  page-break-after: avoid;
}
.sh-icon { color: var(--pr-accent); font-size: 12px; }
.completed-heading { background: linear-gradient(135deg, #166534, #15803d); }
.inprogress-heading { background: linear-gradient(135deg, #92400e, #b45309); }
.notstarted-heading { background: linear-gradient(135deg, #991b1b, #b91c1c); }

/* ===== Executive Summary ===== */
.exec-summary { margin-bottom: 8px; }
.summary-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}
.sum-card {
  border: 1px solid var(--pr-border-light);
  border-radius: 10px;
  padding: 14px 12px;
  text-align: center;
  background: var(--pr-bg-alt);
  position: relative;
  overflow: hidden;
}
.sum-card::before {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  height: 4px;
}
.sum-card.card-total::before { background: var(--pr-primary); }
.sum-card.card-completed::before { background: var(--pr-completed); }
.sum-card.card-inprogress::before { background: var(--pr-inprogress); }
.sum-card.card-notstarted::before { background: var(--pr-notstarted); }
.sum-card.card-rate::before { background: var(--pr-accent); }
.sum-label {
  display: block;
  font-size: 12px;
  font-weight: 700;
  color: var(--pr-text-muted);
  margin-bottom: 6px;
}
.sum-value {
  display: block;
  font-size: 30px;
  font-weight: 900;
  line-height: 1;
}
.sum-value.total-v { color: var(--pr-primary); }
.sum-value.completed-v { color: var(--pr-completed); }
.sum-value.inprogress-v { color: var(--pr-inprogress); }
.sum-value.notstarted-v { color: var(--pr-notstarted); }
.sum-value.rate-v { color: var(--pr-accent); }
.sum-sub {
  display: block;
  font-size: 11px;
  color: var(--pr-text-muted);
  margin-top: 4px;
  font-weight: 600;
}

/* ===== Overall Progress Ring ===== */
.overall-progress-section {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 40px;
  padding: 20px 0;
  margin-bottom: 8px;
  page-break-inside: avoid;
}
.overall-ring-wrap {
  width: var(--pr-ring-size);
  height: var(--pr-ring-size);
  flex-shrink: 0;
}
.overall-ring-wrap svg { width: 100%; height: 100%; }
.ring-bg { fill: none; stroke: #e8eeed; stroke-width: 12; }
.ring-fg { fill: none; stroke-width: 12; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
.ring-text {
  font-family: 'Cairo', sans-serif;
  font-weight: 900;
  fill: var(--pr-primary-dark);
}
.ring-label {
  font-family: 'Cairo', sans-serif;
  font-weight: 700;
  font-size: 11px;
  fill: var(--pr-text-muted);
}
.overall-details { display: flex; flex-direction: column; gap: 10px; }
.legend-item {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 14px;
  font-weight: 700;
}
.legend-dot {
  width: 14px;
  height: 14px;
  border-radius: 4px;
  flex-shrink: 0;
}
.legend-dot.dot-completed { background: var(--pr-completed); }
.legend-dot.dot-inprogress { background: var(--pr-inprogress); }
.legend-dot.dot-notstarted { background: var(--pr-notstarted); }
.legend-count {
  font-size: 20px;
  font-weight: 900;
  min-width: 32px;
}

/* ===== Domain Cards ===== */
.domains-section { margin-bottom: 8px; }
.domains-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
}
.domain-card {
  border: 1px solid var(--pr-border);
  border-radius: 12px;
  padding: 16px;
  background: var(--pr-bg);
  position: relative;
  overflow: hidden;
  page-break-inside: avoid;
}
.domain-card::after {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  width: 5px;
  background: var(--pr-primary);
}
.dc-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 10px;
}
.dc-name {
  font-size: 15px;
  font-weight: 800;
  color: var(--pr-primary-dark);
}
.dc-pct {
  font-size: 26px;
  font-weight: 900;
  color: var(--pr-primary);
  line-height: 1;
}
.dc-bar-track {
  height: 10px;
  background: #e2edeb;
  border-radius: 5px;
  overflow: hidden;
  margin-bottom: 10px;
}
.dc-bar-fill {
  height: 100%;
  border-radius: 5px;
  background: linear-gradient(90deg, var(--pr-primary-light), var(--pr-primary));
  transition: width 0.8s ease;
}
.dc-stats {
  display: flex;
  gap: 16px;
  font-size: 12px;
  font-weight: 700;
}
.dc-stat { display: flex; align-items: center; gap: 4px; }
.dc-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
}
.dc-dot.c { background: var(--pr-completed); }
.dc-dot.p { background: var(--pr-inprogress); }
.dc-dot.n { background: var(--pr-notstarted); }
.dc-stat-num { color: var(--pr-text); }

/* ===== Standards Tables ===== */
.standards-section { margin-bottom: 8px; }
.std-domain-group { margin-bottom: 18px; page-break-inside: avoid; }
.std-domain-title {
  font-size: 15px;
  font-weight: 800;
  color: var(--pr-primary-dark);
  margin: 0 0 8px;
  padding: 8px 12px;
  background: var(--pr-bg-section);
  border-right: 4px solid var(--pr-accent);
  border-radius: 0 6px 6px 0;
}
.std-table {
  width: 100%;
  border-collapse: collapse;
  border: 1px solid var(--pr-border);
  margin-bottom: 6px;
}
.std-table th {
  background: var(--pr-primary);
  color: #fff;
  font-size: 12px;
  font-weight: 700;
  padding: 8px 6px;
  text-align: center;
  border: 1px solid var(--pr-primary-dark);
}
.std-table td {
  border: 1px solid var(--pr-border-light);
  padding: 7px 8px;
  font-size: 12px;
  text-align: center;
  vertical-align: middle;
}
.std-table tbody tr:nth-child(even) td { background: var(--pr-bg-alt); }
.std-name-cell { text-align: right !important; font-weight: 700; color: var(--pr-primary-dark); }
.std-bar-mini {
  display: inline-block;
  width: 60px;
  height: 7px;
  background: #e2edeb;
  border-radius: 4px;
  overflow: hidden;
  vertical-align: middle;
  margin-inline-start: 6px;
}
.std-bar-mini-fill {
  height: 100%;
  border-radius: 4px;
  background: var(--pr-primary);
}

/* ===== Indicators Section ===== */
.indicators-section { margin-bottom: 8px; }
.ind-table {
  width: 100%;
  border-collapse: collapse;
  border: 1px solid var(--pr-border);
  margin-bottom: 6px;
}
.ind-table th {
  font-size: 11px;
  font-weight: 700;
  padding: 7px 5px;
  text-align: center;
  border: 1px solid rgba(255,255,255,0.2);
  color: #fff;
}
.ind-table.completed-table th { background: var(--pr-completed); }
.ind-table.inprogress-table th { background: var(--pr-inprogress); }
.ind-table.notstarted-table th { background: var(--pr-notstarted); }
.ind-table td {
  border: 1px solid var(--pr-border-light);
  padding: 6px 7px;
  font-size: 11px;
  vertical-align: middle;
}
.ind-table tbody tr:nth-child(even) td { background: var(--pr-bg-alt); }
.ind-code {
  display: inline-block;
  background: var(--pr-bg-section);
  color: var(--pr-primary-dark);
  font-weight: 800;
  padding: 2px 8px;
  border-radius: 6px;
  font-size: 11px;
}
.ind-text-cell { text-align: right !important; font-weight: 600; line-height: 1.5; }
.ind-center { text-align: center; font-weight: 700; }
.ind-pct-cell { text-align: center; font-weight: 800; }

.status-badge {
  display: inline-block;
  padding: 3px 10px;
  border-radius: 20px;
  font-size: 10px;
  font-weight: 800;
  white-space: nowrap;
}
.badge-completed { background: var(--pr-completed-bg); color: var(--pr-completed); }
.badge-inprogress { background: var(--pr-inprogress-bg); color: var(--pr-inprogress); }
.badge-notstarted { background: var(--pr-notstarted-bg); color: var(--pr-notstarted); }

.no-data-msg {
  text-align: center;
  padding: 20px;
  font-size: 14px;
  font-weight: 700;
  color: var(--pr-text-muted);
  background: var(--pr-bg-alt);
  border: 1px dashed var(--pr-border);
  border-radius: 8px;
}

/* ===== Recommendations ===== */
.recommendations-section { margin-bottom: 16px; }
.rec-list {
  list-style: none;
  padding: 0;
  margin: 0;
}
.rec-item {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  padding: 10px 14px;
  border-bottom: 1px solid var(--pr-border-light);
  font-size: 13px;
  line-height: 1.7;
  font-weight: 600;
}
.rec-item:last-child { border-bottom: none; }
.rec-icon {
  flex-shrink: 0;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 800;
  color: #fff;
  margin-top: 2px;
}
.rec-icon.priority-high { background: var(--pr-notstarted); }
.rec-icon.priority-med { background: var(--pr-inprogress); }
.rec-icon.priority-low { background: var(--pr-completed); }

/* ===== Signatures ===== */
.signatures-section {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
  margin-top: 32px;
  padding-top: 20px;
  border-top: 2px solid var(--pr-border);
  page-break-inside: avoid;
}
.sig-box {
  text-align: center;
  padding: 16px 10px;
  border: 1px solid var(--pr-border-light);
  border-radius: 10px;
  background: var(--pr-bg-alt);
}
.sig-role {
  font-size: 14px;
  font-weight: 800;
  color: var(--pr-primary-dark);
  margin: 0 0 20px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--pr-accent);
}
.sig-name, .sig-sign, .sig-date-line {
  font-size: 12px;
  font-weight: 600;
  color: var(--pr-text-muted);
  margin: 0 0 14px;
  text-align: right;
}

/* ===== Settings Button ===== */
.tool-btn.settings-btn {
  background: rgba(255,255,255,0.18);
  border-color: rgba(255,255,255,0.35);
}
.tool-btn.settings-btn:hover { background: rgba(255,255,255,0.32); }

/* ===== Modal ===== */
.modal-overlay {
  display: none;
  position: fixed;
  inset: 0;
  z-index: 1000;
  background: rgba(0,0,0,0.5);
  backdrop-filter: blur(4px);
  justify-content: center;
  align-items: center;
}
.modal-overlay.active {
  display: flex;
}
.modal-box {
  background: #fff;
  border-radius: 16px;
  width: 90%;
  max-width: 560px;
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0,0,0,0.25);
  direction: rtl;
}
.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 18px 24px 14px;
  border-bottom: 2px solid var(--pr-border-light);
  background: var(--pr-bg-section);
  border-radius: 16px 16px 0 0;
}
.modal-title {
  margin: 0;
  font-size: 18px;
  font-weight: 800;
  color: var(--pr-primary-dark);
}
.modal-close {
  border: none;
  background: none;
  font-size: 28px;
  color: var(--pr-text-muted);
  cursor: pointer;
  line-height: 1;
  padding: 0 4px;
  transition: color 0.2s;
}
.modal-close:hover { color: var(--pr-notstarted); }
.modal-body {
  padding: 20px 24px;
}
.form-group {
  margin-bottom: 16px;
}
.form-label {
  display: block;
  font-size: 14px;
  font-weight: 700;
  color: var(--pr-primary-dark);
  margin-bottom: 6px;
}
.form-hint {
  font-size: 11px;
  font-weight: 500;
  color: var(--pr-text-muted);
}
.form-input, .form-textarea {
  width: 100%;
  padding: 10px 14px;
  border: 1.5px solid var(--pr-border);
  border-radius: 10px;
  font-family: inherit;
  font-size: 14px;
  font-weight: 600;
  color: var(--pr-text);
  background: var(--pr-bg-alt);
  transition: border-color 0.2s, box-shadow 0.2s;
  direction: rtl;
}
.form-input:focus, .form-textarea:focus {
  outline: none;
  border-color: var(--pr-primary);
  box-shadow: 0 0 0 3px rgba(12,107,96,0.12);
}
.form-textarea {
  resize: vertical;
  min-height: 100px;
  line-height: 1.7;
}
.modal-footer {
  display: flex;
  justify-content: flex-start;
  gap: 10px;
  padding: 14px 24px 18px;
  border-top: 1px solid var(--pr-border-light);
}
.modal-btn {
  padding: 10px 28px;
  border-radius: 10px;
  font-family: inherit;
  font-size: 14px;
  font-weight: 800;
  cursor: pointer;
  border: 1.5px solid transparent;
  transition: all 0.2s;
}
.modal-btn.save {
  background: linear-gradient(135deg, var(--pr-primary-dark), var(--pr-primary));
  color: #fff;
  border-color: var(--pr-primary-dark);
}
.modal-btn.save:hover {
  background: linear-gradient(135deg, var(--pr-primary), var(--pr-primary-light));
}
.modal-btn.cancel {
  background: var(--pr-bg-alt);
  color: var(--pr-text-muted);
  border-color: var(--pr-border);
}
.modal-btn.cancel:hover { background: #e8eeed; }

/* ===== Team Section ===== */
.team-section {
  margin-bottom: 16px;
  page-break-inside: avoid;
}
.team-card {
  border: 1px solid var(--pr-border);
  border-radius: 12px;
  padding: 16px 20px;
  background: var(--pr-bg-alt);
}
.team-card-title {
  font-size: 15px;
  font-weight: 800;
  color: var(--pr-primary-dark);
  margin: 0 0 12px;
  padding-bottom: 8px;
  border-bottom: 2px solid var(--pr-accent);
}
.team-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 10px 24px;
}
.team-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 13px;
  font-weight: 600;
  color: var(--pr-text);
  padding: 6px 0;
  border-bottom: 1px dashed var(--pr-border-light);
}
.team-item:last-child { border-bottom: none; }
.team-num {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  border-radius: 50%;
  background: var(--pr-primary);
  color: #fff;
  font-size: 11px;
  font-weight: 800;
  flex-shrink: 0;
}
.team-info-row {
  display: flex;
  gap: 24px;
  margin-bottom: 12px;
  flex-wrap: wrap;
}
.team-info-item {
  font-size: 13px;
  font-weight: 700;
  color: var(--pr-text);
}
.team-info-label {
  color: var(--pr-text-muted);
  font-weight: 600;
  margin-inline-end: 4px;
}

/* ===== Footer ===== */
.report-footer {
  margin-top: 24px;
  padding-top: 10px;
  border-top: 1px solid var(--pr-border-light);
  text-align: center;
  font-size: 11px;
  color: var(--pr-text-muted);
  font-weight: 600;
}
.report-footer p { margin: 2px 0; }

/* ===== Print Styles ===== */
@media print {
  body {
    background: #fff;
    margin: 0;
    padding: 0;
  }
  .noprint { display: none !important; }
  .report-page {
    max-width: 100%;
    padding: 8mm;
    margin: 0;
  }
  @page {
    size: A4;
    margin: 8mm;
  }
  .section-heading {
    page-break-after: avoid;
  }
  .domain-card,
  .std-domain-group,
  .signatures-section {
    page-break-inside: avoid;
  }
  .indicators-section {
    page-break-before: auto;
  }
}

/* ===== Responsive (screen) ===== */
@media screen and (max-width: 700px) {
  .report-page { padding: 16px; }
  .letterhead {
    grid-template-columns: 1fr;
    text-align: center;
  }
  .lh-right, .lh-left { text-align: center; }
  .summary-grid { grid-template-columns: repeat(2, 1fr); }
  .domains-grid { grid-template-columns: 1fr; }
  .overall-progress-section { flex-direction: column; }
  .signatures-section { grid-template-columns: 1fr; }
}
